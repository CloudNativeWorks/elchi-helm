{
  "dashboard_info": {
    "title": "Elchi All Metrics",
    "uid": "elchi-all-metrics",
    "tags": [
      "elchi",
      "proxy",
      "metrics"
    ],
    "refresh": "10s"
  },
  "datasource": {
    "type": "prometheus",
    "uid": "victoriametrics"
  },
  "metrics": [
    {
      "row_title": "Overview",
      "is_collapsed": false,
      "panels": [
        {
          "title": "Client Status",
          "description": "Client server status",
          "metric_names": [
            "server_live"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "server_live",
              "legend": "Status",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Uptime",
          "description": "Client server uptime",
          "metric_names": [
            "server_uptime"
          ],
          "unit": "s",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "server_uptime",
              "legend": "Uptime",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Total Clusters",
          "description": "Number of upstream clusters",
          "metric_names": [
            "cluster_manager_active_clusters"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_manager_active_clusters",
              "legend": "Clusters",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Warming Clusters",
          "description": "Clusters currently warming",
          "metric_names": [
            "cluster_manager_warming_clusters"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_manager_warming_clusters",
              "legend": "Warming",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Total Members",
          "description": "Total upstream members across all clusters",
          "metric_names": [
            "cluster_membership_total"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_membership_total",
              "legend": "Total",
              "type": "gauge",
              "group_by": "",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Healthy Members",
          "description": "Total healthy upstream members across all clusters",
          "metric_names": [
            "cluster_membership_healthy"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_membership_healthy",
              "legend": "Healthy",
              "type": "gauge",
              "group_by": "",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Degraded Members",
          "description": "Total degraded upstream members",
          "metric_names": [
            "cluster_membership_degraded"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_membership_degraded",
              "legend": "Degraded",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Health Check Failures",
          "description": "Active health check failures",
          "metric_names": [
            "cluster_health_check_failure_total"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_health_check_failure_total",
              "legend": "HC Failures",
              "type": "rate",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Memory Allocated",
          "description": "Memory allocated by Envoy",
          "metric_names": [
            "server_memory_allocated"
          ],
          "unit": "bytes",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "server_memory_allocated",
              "legend": "Allocated",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Heap Size",
          "description": "Total heap size",
          "metric_names": [
            "server_memory_heap_size"
          ],
          "unit": "bytes",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "server_memory_heap_size",
              "legend": "Heap",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Certificate Expiry",
          "description": "Days until first certificate expires",
          "metric_names": [
            "server_days_until_first_cert_expiring"
          ],
          "unit": "d",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "server_days_until_first_cert_expiring",
              "legend": "Days",
              "type": "gauge",
              "group_by": "",
              "max_value": 3650,
              "default_value": 0
            }
          ]
        },
        {
          "title": "Active Connections",
          "description": "Total active downstream connections",
          "metric_names": [
            "http_downstream_cx_active"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "http_downstream_cx_active",
              "legend": "Connections",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Request Rate",
          "description": "Total requests per second",
          "metric_names": [
            "http_downstream_rq_total"
          ],
          "unit": "reqps",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "http_downstream_rq_total",
              "legend": "RPS",
              "type": "rate",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Active Requests",
          "description": "Currently processing requests",
          "metric_names": [
            "http_downstream_rq_active"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "http_downstream_rq_active",
              "legend": "Active",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Error Rate (5xx)",
          "description": "Server errors per second",
          "metric_names": [
            "http_downstream_rq_5xx_total"
          ],
          "unit": "reqps",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "http_downstream_rq_5xx_total",
              "legend": "5xx/s",
              "type": "rate",
              "group_by": "",
              "default_value": 0
            }
          ]
        },
        {
          "title": "Ejected Hosts",
          "description": "Hosts ejected by outlier detection",
          "metric_names": [
            "cluster_ejections_active"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_ejections_active",
              "legend": "Ejected",
              "type": "gauge",
              "group_by": "",
              "default_value": 0
            }
          ]
        },
        {
          "title": "Worker Threads",
          "description": "Number of worker threads",
          "metric_names": [
            "server_concurrency"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "server_concurrency",
              "legend": "Threads",
              "type": "gauge",
              "group_by": ""
            }
          ]
        },
        {
          "title": "Total Connections",
          "description": "Total connections (new + old processes)",
          "metric_names": [
            "server_total_connections"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "server_total_connections",
              "legend": "Total",
              "type": "gauge",
              "group_by": "",
              "default_value": 0
            }
          ]
        },
        {
          "title": "Client Errors (4xx)",
          "description": "Client errors per second",
          "metric_names": [
            "http_downstream_rq_4xx_total"
          ],
          "unit": "reqps",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "http_downstream_rq_4xx_total",
              "legend": "4xx/s",
              "type": "rate",
              "group_by": "",
              "default_value": 0
            }
          ]
        },
        {
          "title": "Upstream Cx Active",
          "description": "Active upstream connections",
          "metric_names": [
            "cluster_upstream_cx_active"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_upstream_cx_active",
              "legend": "Active",
              "type": "gauge",
              "group_by": "",
              "default_value": 0
            }
          ]
        },
        {
          "title": "Retries",
          "description": "Retry requests per second",
          "metric_names": [
            "cluster_upstream_rq_retry_total"
          ],
          "unit": "reqps",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_upstream_rq_retry_total",
              "legend": "Retry/s",
              "type": "rate",
              "group_by": "",
              "default_value": 0
            }
          ]
        },
        {
          "title": "Response Time (p99)",
          "description": "99th percentile response time",
          "metric_names": [
            "http_downstream_rq_time_bucket"
          ],
          "unit": "ms",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "http_downstream_rq_time_bucket",
              "legend": "p99",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "",
              "default_value": 0
            }
          ]
        },
        {
          "title": "Circuit Breaker Opens",
          "description": "Circuit breaker open events",
          "metric_names": [
            "cluster_circuit_breakers_default_cx_open_total",
            "cluster_circuit_breakers_default_rq_open_total"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_circuit_breakers_default_cx_open_total",
              "legend": "Cx",
              "type": "rate",
              "group_by": "",
              "default_value": 0
            },
            {
              "metric": "cluster_circuit_breakers_default_rq_open_total",
              "legend": "Rq",
              "type": "rate",
              "group_by": "",
              "default_value": 0
            }
          ]
        },
        {
          "title": "Cx Pool Overflow",
          "description": "Connection pool overflow events",
          "metric_names": [
            "cluster_upstream_cx_overflow_total"
          ],
          "unit": "short",
          "panel_type": "stat",
          "width": 2,
          "queries": [
            {
              "metric": "cluster_upstream_cx_overflow_total",
              "legend": "Overflow/s",
              "type": "rate",
              "group_by": "",
              "default_value": 0
            }
          ]
        }
      ]
    },
    {
      "row_title": "Downstream - Connection Metrics",
      "is_collapsed": false,
      "panels": [
        {
          "title": "Downstream Connections from Clients",
          "description": "Rate of new downstream connections and active connections",
          "metric_names": [
            "http_downstream_cx_total",
            "http_downstream_cx_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "http_downstream_cx_total",
              "legend": "Rate - HTTP: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_active",
              "legend": "Active: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Connections Destroyed with Active Requests",
          "description": "Rate of downstream connections destroyed with one or more active requests",
          "metric_names": [
            "downstream_cx_destroy_active_rq_total",
            "downstream_cx_destroy_local_active_rq_total",
            "downstream_cx_destroy_remote_active_rq_total"
          ],
          "unit": "cps",
          "queries": [
            {
              "metric": "http_downstream_cx_destroy_active_rq_total",
              "legend": "Total: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_destroy_local_active_rq_total",
              "legend": "Local Close: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_destroy_remote_active_rq_total",
              "legend": "Remote Close: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Connections by HTTP Version",
          "description": "Rate of new downstream connections and currently active connections by HTTP protocol version",
          "metric_names": [
            "http_downstream_cx_http1_total",
            "http_downstream_cx_http2_total",
            "http_downstream_cx_http3_total",
            "http_downstream_cx_http1_active",
            "http_downstream_cx_http2_active",
            "http_downstream_cx_http3_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "http_downstream_cx_http1_total",
              "legend": "Rate - HTTP/1: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_http2_total",
              "legend": "Rate - HTTP/2: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_http3_total",
              "legend": "Rate - HTTP/3: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_http1_active",
              "legend": "Active - HTTP/1: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_http2_active",
              "legend": "Active - HTTP/2: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_http3_active",
              "legend": "Active - HTTP/3: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Connection Duration",
          "description": "Duration distribution of downstream client connections",
          "metric_names": [
            "http_downstream_cx_length_ms_bucket"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": "http_downstream_cx_length_ms_bucket",
              "legend": "p50: {{envoy_http_conn_manager_prefix}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_length_ms_bucket",
              "legend": "p90: {{envoy_http_conn_manager_prefix}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_length_ms_bucket",
              "legend": "p95: {{envoy_http_conn_manager_prefix}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_length_ms_bucket",
              "legend": "p99: {{envoy_http_conn_manager_prefix}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Connection Destroy Rate",
          "description": "Rate of downstream connections being destroyed",
          "metric_names": [
            "downstream_cx_destroy_total",
            "downstream_cx_destroy_remote_total",
            "downstream_cx_destroy_local_total"
          ],
          "unit": "cps",
          "queries": [
            {
              "metric": "http_downstream_cx_destroy_total",
              "legend": "Total: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_destroy_remote_total",
              "legend": "Remote Close: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_destroy_local_total",
              "legend": "Local Close: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Connection Bytes Rate",
          "description": "Rate of bytes received from (RX) and sent to (TX) downstream clients per second",
          "metric_names": [
            "downstream_cx_rx_bytes_total",
            "downstream_cx_tx_bytes_total"
          ],
          "unit": "Bps",
          "queries": [
            {
              "metric": "http_downstream_cx_rx_bytes_total",
              "legend": "RX: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_tx_bytes_total",
              "legend": "TX: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Connection Buffered Bytes",
          "description": "Currently buffered bytes waiting to be received (RX) or sent (TX)",
          "metric_names": [
            "http_downstream_cx_rx_bytes_buffered",
            "http_downstream_cx_tx_bytes_buffered"
          ],
          "unit": "bytes",
          "queries": [
            {
              "metric": "http_downstream_cx_rx_bytes_buffered",
              "legend": "RX Buffered: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_tx_bytes_buffered",
              "legend": "TX Buffered: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Protocol Errors",
          "description": "Rate of protocol errors detected on downstream client connections",
          "metric_names": [
            "downstream_cx_protocol_error_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http_downstream_cx_protocol_error_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Connections Closed Due to Draining",
          "description": "Rate of downstream connections closed due to draining",
          "metric_names": [
            "downstream_cx_drain_close_total"
          ],
          "unit": "cps",
          "queries": [
            {
              "metric": "http_downstream_cx_drain_close_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Connections Closed Due to Timeout & Limits",
          "description": "Rate of downstream connections closed due to idle timeout and reaching configured limits",
          "metric_names": [
            "downstream_cx_idle_timeout_total",
            "downstream_cx_max_duration_reached_total",
            "downstream_cx_max_requests_reached_total"
          ],
          "unit": "cps",
          "queries": [
            {
              "metric": "http_downstream_cx_idle_timeout_total",
              "legend": "Idle Timeout: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_max_duration_reached_total",
              "legend": "Max Duration: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_max_requests_reached_total",
              "legend": "Max Requests: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Overload & Flow Control Events",
          "description": "Rate of overload protection and flow control events",
          "metric_names": [
            "downstream_cx_overload_disable_keepalive_total",
            "downstream_flow_control_paused_reading_total",
            "downstream_flow_control_resumed_reading_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http_downstream_cx_overload_disable_keepalive_total",
              "legend": "Keepalive Disabled (Overload): {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_flow_control_paused_reading_total",
              "legend": "Flow Control Paused: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_flow_control_resumed_reading_total",
              "legend": "Flow Control Resumed: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream SSL/TLS Connections",
          "description": "Rate of new SSL/TLS downstream connections and currently active SSL/TLS connections",
          "metric_names": [
            "http_downstream_cx_ssl_total",
            "http_downstream_cx_ssl_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "http_downstream_cx_ssl_total",
              "legend": "Rate: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_ssl_active",
              "legend": "Active: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Protocol Upgrades",
          "description": "Rate of protocol upgrades on downstream connections and currently active upgraded connections",
          "metric_names": [
            "downstream_cx_upgrades_total",
            "downstream_cx_upgrades_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "http_downstream_cx_upgrades_total",
              "legend": "Rate: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_cx_upgrades_active",
              "legend": "Active: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/1 Connections Being Soft Drained",
          "description": "Number of HTTP/1 connections currently being soft-drained",
          "metric_names": [
            "http_downstream_cx_http1_soft_drain"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "http_downstream_cx_http1_soft_drain",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Downstream - Request Metrics",
      "is_collapsed": false,
      "panels": [
        {
          "title": "Downstream Request Rate by HTTP Version",
          "description": "Rate of downstream requests by HTTP protocol version",
          "metric_names": [
            "http_downstream_rq_total",
            "http_downstream_rq_http1_total",
            "http_downstream_rq_http2_total",
            "http_downstream_rq_http3_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "http_downstream_rq_total",
              "legend": "Total: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_http1_total",
              "legend": "HTTP/1: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_http2_total",
              "legend": "HTTP/2: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_http3_total",
              "legend": "HTTP/3: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Response by HTTP Status Class",
          "description": "Rate of downstream responses by HTTP status code class (1xx, 2xx, 3xx, 4xx, 5xx)",
          "metric_names": [
            "http_downstream_rq_xx_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "http_downstream_rq_xx_total",
              "legend": "{{envoy_response_code_class}}xx: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix, envoy_response_code_class"
            }
          ]
        },
        {
          "title": "Downstream Request Time",
          "description": "Total time for request and response in milliseconds (p50, p90, p95, p99)",
          "metric_names": [
            "http_downstream_rq_time_bucket"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": "http_downstream_rq_time_bucket",
              "legend": "p50: {{envoy_http_conn_manager_prefix}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_time_bucket",
              "legend": "p90: {{envoy_http_conn_manager_prefix}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_time_bucket",
              "legend": "p95: {{envoy_http_conn_manager_prefix}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_time_bucket",
              "legend": "p99: {{envoy_http_conn_manager_prefix}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Completed Requests",
          "description": "Rate of downstream requests that completed successfully",
          "metric_names": [
            "http_downstream_rq_completed_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "http_downstream_rq_completed_total",
              "legend": "HTTP: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Request Errors",
          "description": "Rate of downstream request errors",
          "metric_names": [
            "http_downstream_rq_rejected_via_ip_detection_total",
            "http_downstream_rq_response_before_rq_complete_total",
            "http_downstream_rq_non_relative_path_total",
            "http_downstream_rq_failed_path_normalization_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "http_downstream_rq_rejected_via_ip_detection_total",
              "legend": "Rejected (IP Detection Failed): {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_response_before_rq_complete_total",
              "legend": "Response Before Request Complete: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_non_relative_path_total",
              "legend": "Non-Relative Path: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_failed_path_normalization_total",
              "legend": "Failed Path Normalization: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Request Resets",
          "description": "Rate of downstream request resets",
          "metric_names": [
            "http_downstream_rq_rx_reset_total",
            "http_downstream_rq_tx_reset_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "http_downstream_rq_rx_reset_total",
              "legend": "RX Reset (Received): {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_tx_reset_total",
              "legend": "TX Reset (Sent): {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Requests Too Large - 413 Error",
          "description": "Rate of requests resulting in 413 status",
          "metric_names": [
            "http_downstream_rq_too_large_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "http_downstream_rq_too_large_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream WebSocket Upgrade Rejections",
          "description": "Total upgrade requests rejected by non-upgrade routes (WebSocket and non-WebSocket upgrades)",
          "metric_names": [
            "http_downstream_rq_ws_on_non_ws_route_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "http_downstream_rq_ws_on_non_ws_route_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Request Timeout & Duration Errors",
          "description": "Rate of requests closed due to timeouts and duration limits",
          "metric_names": [
            "http_downstream_rq_idle_timeout_total",
            "http_downstream_rq_timeout_total",
            "http_downstream_rq_max_duration_reached_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "http_downstream_rq_idle_timeout_total",
              "legend": "Idle Timeout: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_timeout_total",
              "legend": "Request Timeout: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_max_duration_reached_total",
              "legend": "Max Duration: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Downstream Request & Response Errors",
          "description": "Rate of various downstream request and response errors (overload, redirects, premature resets, oversized responses)",
          "metric_names": [
            "http_downstream_rq_overload_close_total",
            "http_downstream_rq_redirected_with_normalized_path_total",
            "http_downstream_rq_too_many_premature_resets_total",
            "http_rs_too_large_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http_downstream_rq_overload_close_total",
              "legend": "Overload Close: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_redirected_with_normalized_path_total",
              "legend": "Redirected (Normalized Path): {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_downstream_rq_too_many_premature_resets_total",
              "legend": "Too Many Premature Resets: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http_rs_too_large_total",
              "legend": "Response Too Large: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/3 QUIC Errors",
          "description": "Rate of HTTP/3 QUIC connection close and stream reset errors (TX and RX)",
          "metric_names": [
            "http3_downstream_tx_quic_connection_close_error_code",
            "http3_downstream_rx_quic_connection_close_error_code",
            "http3_downstream_tx_quic_reset_stream_error_code",
            "http3_downstream_rx_quic_reset_stream_error_code"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http3_downstream_tx_quic_connection_close_error_code_.*_total",
              "legend": "Connection Close TX: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http3_downstream_rx_quic_connection_close_error_code_.*_total",
              "legend": "Connection Close RX: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http3_downstream_tx_quic_reset_stream_error_code_.*_total",
              "legend": "Stream Reset TX: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http3_downstream_rx_quic_reset_stream_error_code_.*_total",
              "legend": "Stream Reset RX: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/1 Protocol Errors",
          "description": "Rate of HTTP/1 specific errors (header issues, metadata, response flooding)",
          "metric_names": [
            "http1_dropped_headers_with_underscores_total",
            "http1_metadata_not_supported_error_total",
            "http1_response_flood_total",
            "http1_requests_rejected_with_underscores_in_headers_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http1_dropped_headers_with_underscores_total",
              "legend": "Dropped Headers: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http1_metadata_not_supported_error_total",
              "legend": "Metadata Error: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http1_response_flood_total",
              "legend": "Response Flood: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http1_requests_rejected_with_underscores_in_headers_total",
              "legend": "Rejected Requests: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/2 Header Errors",
          "description": "Rate of HTTP/2 header-related errors (dropped headers, rejected requests, overflow)",
          "metric_names": [
            "http2_dropped_headers_with_underscores_total",
            "http2_requests_rejected_with_underscores_in_headers_total",
            "http2_header_overflow_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http2_dropped_headers_with_underscores_total",
              "legend": "Dropped Headers: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_requests_rejected_with_underscores_in_headers_total",
              "legend": "Rejected Requests: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_header_overflow_total",
              "legend": "Header Overflow: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/2 Flood Protection",
          "description": "Rate of HTTP/2 flood protection events (inbound empty/priority/window frames, outbound control/frames)",
          "metric_names": [
            "http2_inbound_empty_frames_flood_total",
            "http2_inbound_priority_frames_flood_total",
            "http2_inbound_window_update_frames_flood_total",
            "http2_outbound_control_flood_total",
            "http2_outbound_flood_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http2_inbound_empty_frames_flood_total",
              "legend": "Inbound Empty Frames: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_inbound_priority_frames_flood_total",
              "legend": "Inbound Priority Frames: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_inbound_window_update_frames_flood_total",
              "legend": "Inbound Window Update Frames: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_outbound_control_flood_total",
              "legend": "Outbound Control Flood: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_outbound_flood_total",
              "legend": "Outbound Flood: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/2 Connection Events",
          "description": "Rate of HTTP/2 connection management events (goaway, keepalive timeout, flush timeout)",
          "metric_names": [
            "http2_goaway_sent_total",
            "http2_keepalive_timeout_total",
            "http2_tx_flush_timeout_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http2_goaway_sent_total",
              "legend": "Goaway Sent: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_keepalive_timeout_total",
              "legend": "Keepalive Timeout: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_tx_flush_timeout_total",
              "legend": "TX Flush Timeout: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/2 Stream Resets & Errors",
          "description": "Rate of HTTP/2 stream resets and errors (RX/TX resets, refused streams, messaging errors)",
          "metric_names": [
            "http2_rx_reset_total",
            "http2_tx_reset_total",
            "http2_stream_refused_errors_total",
            "http2_rx_messaging_error_total",
            "http2_headers_cb_no_stream_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http2_rx_reset_total",
              "legend": "RX Reset: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_tx_reset_total",
              "legend": "TX Reset: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_stream_refused_errors_total",
              "legend": "Stream Refused: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_rx_messaging_error_total",
              "legend": "RX Messaging Error: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_headers_cb_no_stream_total",
              "legend": "Headers No Stream: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/2 Active Streams & Frames",
          "description": "Current state of HTTP/2 streams and frames (active streams, frames, pending bytes)",
          "metric_names": [
            "http2_streams_active",
            "http2_outbound_control_frames_active",
            "http2_outbound_frames_active",
            "http2_pending_send_bytes",
            "http2_deferred_stream_close"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "http2_streams_active",
              "legend": "Active Streams: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_outbound_control_frames_active",
              "legend": "Outbound Control Frames: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_outbound_frames_active",
              "legend": "Outbound Frames: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_pending_send_bytes",
              "legend": "Pending Send: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_deferred_stream_close",
              "legend": "Deferred Stream Close: {{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/2 Other Metrics",
          "description": "Rate of HTTP/2 metadata and trailer events",
          "metric_names": [
            "http2_metadata_empty_frames_total",
            "http2_trailers_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http2_metadata_empty_frames_total",
              "legend": "Metadata Empty Frames: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http2_trailers_total",
              "legend": "Trailers: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/3 Header Errors",
          "description": "Rate of HTTP/3 header-related errors (dropped headers, rejected requests)",
          "metric_names": [
            "http3_dropped_headers_with_underscores_total",
            "http3_requests_rejected_with_underscores_in_headers_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http3_dropped_headers_with_underscores_total",
              "legend": "Dropped Headers: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http3_requests_rejected_with_underscores_in_headers_total",
              "legend": "Rejected Requests: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/3 Stream Resets",
          "description": "Rate of HTTP/3 stream reset frames (RX and TX)",
          "metric_names": [
            "http3_rx_reset_total",
            "http3_tx_reset_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http3_rx_reset_total",
              "legend": "RX Reset: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http3_tx_reset_total",
              "legend": "TX Reset: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/3 Metadata Errors",
          "description": "Rate of metadata dropped during HTTP/3 encoding",
          "metric_names": [
            "http3_metadata_not_supported_error_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "http3_metadata_not_supported_error_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "HTTP/3 QUIC Protocol Versions",
          "description": "Rate of QUIC connections by transport version (h3-29, rfc-v1)",
          "metric_names": [
            "http3_quic_version_h3_29_total",
            "http3_quic_version_rfc_v1_total"
          ],
          "unit": "cps",
          "queries": [
            {
              "metric": "http3_quic_version_h3_29_total",
              "legend": "h3-29 (deprecated): {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": "http3_quic_version_rfc_v1_total",
              "legend": "RFC v1: {{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Connection Metrics",
      "is_collapsed": false,
      "panels": [
        {
          "title": "Upstream Connections Total & Active",
          "description": "Total and active connections to upstream",
          "metric_names": [
            "cluster_upstream_cx_total",
            "cluster_upstream_cx_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_cx_total",
              "legend": "Total: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_active",
              "legend": "Active: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Connections by HTTP Version",
          "description": "Upstream connections by HTTP version",
          "metric_names": [
            "cluster_upstream_cx_http1_total",
            "cluster_upstream_cx_http2_total",
            "cluster_upstream_cx_http3_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_cx_http1_total",
              "legend": "HTTP/1: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_http2_total",
              "legend": "HTTP/2: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_http3_total",
              "legend": "HTTP/3: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Connection Failures & Timeouts",
          "description": "Connection failures, timeouts and health issues",
          "metric_names": [
            "cluster_upstream_cx_connect_fail_total",
            "cluster_upstream_cx_connect_timeout_total",
            "cluster_upstream_cx_idle_timeout_total",
            "cluster_upstream_cx_connect_attempts_exceeded_total",
            "cluster_upstream_cx_none_healthy_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_cx_connect_fail_total",
              "legend": "Connect Fail: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_connect_timeout_total",
              "legend": "Connect Timeout: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_idle_timeout_total",
              "legend": "Idle Timeout: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_connect_attempts_exceeded_total",
              "legend": "Attempts Exceeded: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_none_healthy_total",
              "legend": "None Healthy: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Connection Times",
          "description": "Connection establishment and length distribution",
          "metric_names": [
            "cluster_upstream_cx_connect_ms_bucket",
            "cluster_upstream_cx_length_ms_bucket"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": "cluster_upstream_cx_connect_ms_bucket",
              "legend": "Connect Time (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_connect_ms_bucket",
              "legend": "Connect Time (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_connect_ms_bucket",
              "legend": "Connect Time (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_connect_ms_bucket",
              "legend": "Connect Time (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_length_ms_bucket",
              "legend": "Length (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_length_ms_bucket",
              "legend": "Length (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_length_ms_bucket",
              "legend": "Length (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_length_ms_bucket",
              "legend": "Length (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Connection Destroy Reasons",
          "description": "Reasons for connection destruction",
          "metric_names": [
            "cluster_upstream_cx_destroy_total",
            "cluster_upstream_cx_destroy_local_total",
            "cluster_upstream_cx_destroy_remote_total",
            "cluster_upstream_cx_destroy_with_active_rq_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_cx_destroy_total",
              "legend": "Total: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_destroy_local_total",
              "legend": "Local: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_destroy_remote_total",
              "legend": "Remote: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_destroy_with_active_rq_total",
              "legend": "With Active RQ: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_destroy_local_with_active_rq_total",
              "legend": "Local With Active RQ: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_destroy_remote_with_active_rq_total",
              "legend": "Remote With Active RQ: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Bytes",
          "description": "Bytes sent and received",
          "metric_names": [
            "cluster_upstream_cx_rx_bytes_total",
            "cluster_upstream_cx_tx_bytes_total",
            "cluster_upstream_cx_rx_bytes_buffered",
            "cluster_upstream_cx_tx_bytes_buffered"
          ],
          "unit": "bytes",
          "queries": [
            {
              "metric": "cluster_upstream_cx_rx_bytes_total",
              "legend": "RX Total: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_tx_bytes_total",
              "legend": "TX Total: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_rx_bytes_buffered",
              "legend": "RX Buffered: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_tx_bytes_buffered",
              "legend": "TX Buffered: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Protocol Errors & Misc",
          "description": "Protocol errors, close notify and 0-RTT",
          "metric_names": [
            "cluster_upstream_cx_protocol_error_total",
            "cluster_upstream_cx_close_notify_total",
            "cluster_upstream_cx_connect_with_0_rtt_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_cx_protocol_error_total",
              "legend": "Protocol Error: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_close_notify_total",
              "legend": "Close Notify: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_connect_with_0_rtt_total",
              "legend": "0-RTT: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Connection Limits & Overflow",
          "description": "Connection limits, overflows and circuit breaking",
          "metric_names": [
            "cluster_upstream_cx_max_duration_reached_total",
            "cluster_upstream_cx_max_requests_total",
            "cluster_upstream_cx_overflow_total",
            "cluster_upstream_cx_pool_overflow_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_cx_max_duration_reached_total",
              "legend": "Max Duration: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_max_requests_total",
              "legend": "Max Requests: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_overflow_total",
              "legend": "CX Overflow: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_cx_pool_overflow_total",
              "legend": "Pool Overflow: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Request Metrics",
      "is_collapsed": false,
      "panels": [
        {
          "title": "Upstream Requests Total & Active",
          "description": "Total and active requests",
          "metric_names": [
            "cluster_upstream_rq_total",
            "cluster_upstream_rq_active"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "cluster_upstream_rq_total",
              "legend": "Total: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_active",
              "legend": "Active: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Pending Requests",
          "description": "Pending requests and overflows",
          "metric_names": [
            "cluster_upstream_rq_pending_total",
            "cluster_upstream_rq_pending_active",
            "cluster_upstream_rq_pending_overflow_total",
            "cluster_upstream_rq_pending_failure_eject_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_rq_pending_total",
              "legend": "Pending Total: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_pending_active",
              "legend": "Pending Active: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_pending_overflow_total",
              "legend": "Pending Overflow: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_pending_failure_eject_total",
              "legend": "Pending Eject: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Requests Per Connection",
          "description": "Histogram of requests per connection",
          "metric_names": [
            "cluster_upstream_rq_per_cx_bucket"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_rq_per_cx_bucket",
              "legend": "Requests/CX (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_per_cx_bucket",
              "legend": "Requests/CX (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_per_cx_bucket",
              "legend": "Requests/CX (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_per_cx_bucket",
              "legend": "Requests/CX (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Request Resets & Cancellations",
          "description": "Request resets, cancellations and maintenance",
          "metric_names": [
            "cluster_upstream_rq_rx_reset_total",
            "cluster_upstream_rq_tx_reset_total",
            "cluster_upstream_rq_cancelled_total",
            "cluster_upstream_rq_maintenance_mode_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_rq_rx_reset_total",
              "legend": "RX Reset: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_tx_reset_total",
              "legend": "TX Reset: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_cancelled_total",
              "legend": "Cancelled: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_maintenance_mode_total",
              "legend": "Maintenance: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Retries",
          "description": "Request retry metrics",
          "metric_names": [
            "cluster_upstream_rq_retry_total",
            "cluster_upstream_rq_retry_success_total",
            "cluster_upstream_rq_retry_limit_exceeded_total",
            "cluster_upstream_rq_retry_overflow_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_rq_retry_total",
              "legend": "Retry Total: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_retry_success_total",
              "legend": "Retry Success: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_retry_limit_exceeded_total",
              "legend": "Limit Exceeded: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_retry_overflow_total",
              "legend": "Overflow: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Request Timeouts & Duration",
          "description": "Request timeouts and duration limits",
          "metric_names": [
            "cluster_upstream_rq_timeout_total",
            "cluster_upstream_rq_per_try_timeout_total",
            "cluster_upstream_rq_max_duration_reached_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_rq_timeout_total",
              "legend": "Timeout: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_per_try_timeout_total",
              "legend": "Per Try Timeout: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_max_duration_reached_total",
              "legend": "Max Duration: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Flow Control",
          "description": "Flow control events",
          "metric_names": [
            "cluster_upstream_flow_control_paused_reading_total",
            "cluster_upstream_flow_control_resumed_reading_total",
            "cluster_upstream_flow_control_backed_up_total",
            "cluster_upstream_flow_control_drained_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_flow_control_paused_reading_total",
              "legend": "Paused: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_flow_control_resumed_reading_total",
              "legend": "Resumed: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_flow_control_backed_up_total",
              "legend": "Backed Up: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_flow_control_drained_total",
              "legend": "Drained: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Upstream Internal Redirects",
          "description": "Internal redirect success and failure",
          "metric_names": [
            "cluster_upstream_internal_redirect_failed_total",
            "cluster_upstream_internal_redirect_succeeded_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_internal_redirect_failed_total",
              "legend": "Failed: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_internal_redirect_succeeded_total",
              "legend": "Succeeded: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - HTTP/3 Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "QUIC Connection Close Errors",
          "description": "QUIC connection close error codes",
          "metric_names": [
            "cluster_upstream_tx_quic_connection_close_error_code_.*_total",
            "cluster_upstream_rx_quic_connection_close_error_code_.*_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_tx_quic_connection_close_error_code_.*_total",
              "legend": "TX Error: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rx_quic_connection_close_error_code_.*_total",
              "legend": "RX Error: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "QUIC Stream Reset Errors",
          "description": "QUIC stream reset error codes",
          "metric_names": [
            "cluster_upstream_tx_quic_reset_stream_error_code_.*_total",
            "cluster_upstream_rx_quic_reset_stream_error_code_.*_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_tx_quic_reset_stream_error_code_.*_total",
              "legend": "TX Reset: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rx_quic_reset_stream_error_code_.*_total",
              "legend": "RX Reset: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Health Check",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Health Check Outcomes",
          "description": "Active health check attempts, successes and failures",
          "metric_names": [
            "cluster_health_check_attempt_total",
            "cluster_health_check_success_total",
            "cluster_health_check_failure_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "cluster_health_check_attempt_total",
              "legend": "Attempt",
              "type": "rate",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_health_check_success_total",
              "legend": "Success",
              "type": "rate",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_health_check_failure_total",
              "legend": "Failure",
              "type": "rate",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Failure Types",
          "description": "Breakdown of health check failures by passive and network causes",
          "metric_names": [
            "cluster_health_check_passive_failure_total",
            "cluster_health_check_network_failure_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "cluster_health_check_passive_failure_total",
              "legend": "Passive Failure",
              "type": "rate",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_health_check_network_failure_total",
              "legend": "Network Failure",
              "type": "rate",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Cluster Verification",
          "description": "Health checks that attempted cluster name verification",
          "metric_names": [
            "cluster_health_check_verify_cluster_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "cluster_health_check_verify_cluster_total",
              "legend": "Verify Cluster",
              "type": "rate",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Healthy Hosts",
          "description": "Number of upstream hosts currently healthy vs total cluster membership",
          "metric_names": [
            "cluster_health_check_healthy",
            "_cluster_membership_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_health_check_healthy",
              "legend": "Healthy",
              "type": "gauge",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_membership_total",
              "legend": "Total Hosts",
              "type": "gauge",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Outlier Detection",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Ejections Overview",
          "description": "Overview of outlier ejections",
          "metric_names": [
            "cluster_outlier_detection_ejections_active",
            "cluster_outlier_detection_ejections_enforced_total",
            "cluster_outlier_detection_ejections_overflow_total",
            "cluster_outlier_detection_ejections_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_outlier_detection_ejections_active",
              "legend": "Active: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_enforced_total",
              "legend": "Enforced Total: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_overflow_total",
              "legend": "Overflow: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_total",
              "legend": "Total (Deprecated): {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Consecutive 5xx & Gateway Failures",
          "description": "Ejections due to consecutive 5xx and gateway failures",
          "metric_names": [
            "cluster_outlier_detection_ejections_enforced_consecutive_5xx_total",
            "cluster_outlier_detection_ejections_detected_consecutive_5xx_total",
            "cluster_outlier_detection_ejections_enforced_consecutive_gateway_failure_total",
            "cluster_outlier_detection_ejections_detected_consecutive_gateway_failure_total",
            "cluster_outlier_detection_ejections_consecutive_5xx_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_outlier_detection_ejections_enforced_consecutive_5xx_total",
              "legend": "Enforced 5xx: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_detected_consecutive_5xx_total",
              "legend": "Detected 5xx: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_enforced_consecutive_gateway_failure_total",
              "legend": "Enforced Gateway: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_detected_consecutive_gateway_failure_total",
              "legend": "Detected Gateway: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_consecutive_5xx_total",
              "legend": "Consecutive 5xx (Deprecated): {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Success Rate Ejections",
          "description": "Ejections due to success rate outliers",
          "metric_names": [
            "cluster_outlier_detection_ejections_enforced_success_rate_total",
            "cluster_outlier_detection_ejections_detected_success_rate_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_outlier_detection_ejections_enforced_success_rate_total",
              "legend": "Enforced Success Rate: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_detected_success_rate_total",
              "legend": "Detected Success Rate: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Failure Percentage Ejections",
          "description": "Ejections due to failure percentage outliers",
          "metric_names": [
            "cluster_outlier_detection_ejections_enforced_failure_percentage_total",
            "cluster_outlier_detection_ejections_detected_failure_percentage_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_outlier_detection_ejections_enforced_failure_percentage_total",
              "legend": "Enforced Failure %: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_detected_failure_percentage_total",
              "legend": "Detected Failure %: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Local Origin Ejections",
          "description": "Ejections due to local origin failures",
          "metric_names": [
            "cluster_outlier_detection_ejections_enforced_consecutive_local_origin_failure_total",
            "cluster_outlier_detection_ejections_detected_consecutive_local_origin_failure_total",
            "cluster_outlier_detection_ejections_enforced_local_origin_success_rate_total",
            "cluster_outlier_detection_ejections_detected_local_origin_success_rate_total",
            "cluster_outlier_detection_ejections_enforced_failure_percentage_local_origin_total",
            "cluster_outlier_detection_ejections_detected_failure_percentage_local_origin_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_outlier_detection_ejections_enforced_consecutive_local_origin_failure_total",
              "legend": "Enforced Local Consecutive: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_detected_consecutive_local_origin_failure_total",
              "legend": "Detected Local Consecutive: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_enforced_local_origin_success_rate_total",
              "legend": "Enforced Local Success Rate: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_detected_local_origin_success_rate_total",
              "legend": "Detected Local Success Rate: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_enforced_failure_percentage_local_origin_total",
              "legend": "Enforced Local Failure %: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_outlier_detection_ejections_detected_failure_percentage_local_origin_total",
              "legend": "Detected Local Failure %: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Circuit Breakers",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Circuit Breaker State",
          "description": "Circuit breaker state (0=Closed, 1=Open)",
          "metric_names": [
            "cluster_circuit_breakers_default_cx_open",
            "cluster_circuit_breakers_default_cx_pool_open",
            "cluster_circuit_breakers_default_rq_pending_open",
            "cluster_circuit_breakers_default_rq_open",
            "cluster_circuit_breakers_default_rq_retry_open"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_circuit_breakers_default_cx_open",
              "legend": "CX Open: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_circuit_breakers_default_cx_pool_open",
              "legend": "Pool Open: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_circuit_breakers_default_rq_pending_open",
              "legend": "Pending Open: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_circuit_breakers_default_rq_open",
              "legend": "RQ Open: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_circuit_breakers_default_rq_retry_open",
              "legend": "Retry Open: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Circuit Breaker Remaining Resources",
          "description": "Remaining resources before circuit breaking",
          "metric_names": [
            "cluster_circuit_breakers_default_remaining_cx",
            "cluster_circuit_breakers_default_remaining_pending",
            "cluster_circuit_breakers_default_remaining_rq",
            "cluster_circuit_breakers_default_remaining_retries"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_circuit_breakers_default_remaining_cx",
              "legend": "Remaining CX: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_circuit_breakers_default_remaining_pending",
              "legend": "Remaining Pending: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_circuit_breakers_default_remaining_rq",
              "legend": "Remaining RQ: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_circuit_breakers_default_remaining_retries",
              "legend": "Remaining Retries: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Timeout Budget",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Timeout Budget Percent Used",
          "description": "Percentage of global timeout used waiting for response",
          "metric_names": [
            "cluster_upstream_rq_timeout_budget_percent_used_bucket"
          ],
          "unit": "percent",
          "queries": [
            {
              "metric": "cluster_upstream_rq_timeout_budget_percent_used_bucket",
              "legend": "Global Timeout Used (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_timeout_budget_percent_used_bucket",
              "legend": "Global Timeout Used (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_timeout_budget_percent_used_bucket",
              "legend": "Global Timeout Used (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_timeout_budget_percent_used_bucket",
              "legend": "Global Timeout Used (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Timeout Budget Per Try Percent Used",
          "description": "Percentage of per try timeout used waiting for response",
          "metric_names": [
            "cluster_upstream_rq_timeout_budget_per_try_percent_used_bucket"
          ],
          "unit": "percent",
          "queries": [
            {
              "metric": "cluster_upstream_rq_timeout_budget_per_try_percent_used_bucket",
              "legend": "Per Try Timeout Used (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_timeout_budget_per_try_percent_used_bucket",
              "legend": "Per Try Timeout Used (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_timeout_budget_per_try_percent_used_bucket",
              "legend": "Per Try Timeout Used (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_timeout_budget_per_try_percent_used_bucket",
              "legend": "Per Try Timeout Used (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Dynamic HTTP Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "General HTTP Requests",
          "description": "General dynamic HTTP statistics",
          "metric_names": [
            "cluster_upstream_rq_completed_total",
            "cluster_upstream_rq_xx_total",
            "cluster_upstream_rq_[0-9]{3}_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_upstream_rq_completed_total",
              "legend": "Completed: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_xx_total",
              "legend": "Response {{envoy_response_code_class}}xx: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name, envoy_response_code_class",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_[0-9]{3}_total",
              "legend": "Code {{__name__}}: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "General HTTP Request Time",
          "description": "General dynamic HTTP request time histogram",
          "metric_names": [
            "cluster_upstream_rq_time_bucket"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": "cluster_upstream_rq_time_bucket",
              "legend": "Time (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_time_bucket",
              "legend": "Time (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_time_bucket",
              "legend": "Time (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_time_bucket",
              "legend": "Time (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "External Origin Requests",
          "description": "External origin dynamic HTTP statistics",
          "metric_names": [
            "cluster_external_upstream_rq_completed_total",
            "cluster_external_upstream_rq_xx_total",
            "cluster_external_upstream_rq_[0-9]{3}_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_external_upstream_rq_completed_total",
              "legend": "External Completed: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_external_upstream_rq_xx_total",
              "legend": "External Response {{envoy_response_code_class}}xx: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name, envoy_response_code_class",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_external_upstream_rq_[0-9]{3}_total",
              "legend": "External Code {{__name__}}: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "External Origin Request Time",
          "description": "External origin dynamic HTTP request time histogram",
          "metric_names": [
            "cluster_external_upstream_rq_time_bucket"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": "cluster_external_upstream_rq_time_bucket",
              "legend": "External Time (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_external_upstream_rq_time_bucket",
              "legend": "External Time (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_external_upstream_rq_time_bucket",
              "legend": "External Time (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_external_upstream_rq_time_bucket",
              "legend": "External Time (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Canary HTTP Requests",
          "description": "Canary dynamic HTTP statistics",
          "metric_names": [
            "cluster_canary_upstream_rq_completed_total",
            "cluster_canary_upstream_rq_xx_total",
            "cluster_canary_upstream_rq_[0-9]{3}_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_canary_upstream_rq_completed_total",
              "legend": "Canary Completed: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_canary_upstream_rq_xx_total",
              "legend": "Canary Response {{envoy_response_code_class}}xx: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name, envoy_response_code_class",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_canary_upstream_rq_[0-9]{3}_total",
              "legend": "Canary Code {{__name__}}: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Canary HTTP Request Time",
          "description": "Canary dynamic HTTP request time histogram",
          "metric_names": [
            "cluster_canary_upstream_rq_time_bucket"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": "cluster_canary_upstream_rq_time_bucket",
              "legend": "Canary Time (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_canary_upstream_rq_time_bucket",
              "legend": "Canary Time (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_canary_upstream_rq_time_bucket",
              "legend": "Canary Time (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_canary_upstream_rq_time_bucket",
              "legend": "Canary Time (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Internal Origin Requests",
          "description": "Internal origin dynamic HTTP statistics",
          "metric_names": [
            "cluster_internal_upstream_rq_completed_total",
            "cluster_internal_upstream_rq_xx_total",
            "cluster_internal_upstream_rq_[0-9]{3}_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_internal_upstream_rq_completed_total",
              "legend": "Internal Completed: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_internal_upstream_rq_xx_total",
              "legend": "Internal Response {{envoy_response_code_class}}xx: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name, envoy_response_code_class",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_internal_upstream_rq_[0-9]{3}_total",
              "legend": "Internal Code {{__name__}}: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Internal Origin Request Time",
          "description": "Internal origin dynamic HTTP request time histogram",
          "metric_names": [
            "cluster_internal_upstream_rq_time_bucket"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": "cluster_internal_upstream_rq_time_bucket",
              "legend": "Internal Time (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_internal_upstream_rq_time_bucket",
              "legend": "Internal Time (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_internal_upstream_rq_time_bucket",
              "legend": "Internal Time (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_internal_upstream_rq_time_bucket",
              "legend": "Internal Time (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - TLS Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "TLS Connection State",
          "description": "TLS connection state statistics",
          "metric_names": [
            "cluster_ssl_handshake_total",
            "cluster_ssl_session_reused_total",
            "cluster_ssl_connection_error_total",
            "cluster_ssl_no_certificate_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_ssl_handshake_total",
              "legend": "Handshake: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_session_reused_total",
              "legend": "Session Reused: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_connection_error_total",
              "legend": "Connection Error: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_no_certificate_total",
              "legend": "No Certificate: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "TLS Verification Failures",
          "description": "TLS verification failure statistics",
          "metric_names": [
            "cluster_ssl_fail_verify_no_cert_total",
            "cluster_ssl_fail_verify_error_total",
            "cluster_ssl_fail_verify_san_total",
            "cluster_ssl_fail_verify_cert_hash_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_ssl_fail_verify_no_cert_total",
              "legend": "Fail Verify No Cert: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_fail_verify_error_total",
              "legend": "Fail Verify Error: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_fail_verify_san_total",
              "legend": "Fail Verify SAN: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_fail_verify_cert_hash_total",
              "legend": "Fail Verify Cert Hash: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "TLS OCSP Stapling",
          "description": "TLS OCSP stapling statistics",
          "metric_names": [
            "cluster_ssl_ocsp_staple_failed_total",
            "cluster_ssl_ocsp_staple_omitted_total",
            "cluster_ssl_ocsp_staple_responses_total",
            "cluster_ssl_ocsp_staple_requests_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_ssl_ocsp_staple_failed_total",
              "legend": "OCSP Failed: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_ocsp_staple_omitted_total",
              "legend": "OCSP Omitted: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_ocsp_staple_responses_total",
              "legend": "OCSP Responses: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_ocsp_staple_requests_total",
              "legend": "OCSP Requests: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "TLS Ciphers & Versions",
          "description": "TLS ciphers, curves, sigalgs, and versions statistics",
          "metric_names": [
            "cluster_ssl_ciphers_.*_total",
            "cluster_ssl_curves_.*_total",
            "cluster_ssl_sigalgs_.*_total",
            "cluster_ssl_versions_.*_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_ssl_ciphers_.*_total",
              "legend": "Cipher {{__name__}}: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_curves_.*_total",
              "legend": "Curve {{__name__}}: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_sigalgs_.*_total",
              "legend": "SigAlg {{__name__}}: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ssl_versions_.*_total",
              "legend": "Version {{__name__}}: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "TLS Key Usage",
          "description": "TLS key usage statistics",
          "metric_names": [
            "cluster_ssl_was_key_usage_invalid_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_ssl_was_key_usage_invalid_total",
              "legend": "Invalid Key Usage: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - TCP Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "TCP Segments",
          "description": "TCP segment statistics",
          "metric_names": [
            "cluster_tcp_stats_cx_tx_segments_total",
            "cluster_tcp_stats_cx_rx_segments_total",
            "cluster_tcp_stats_cx_tx_data_segments_total",
            "cluster_tcp_stats_cx_rx_data_segments_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_tcp_stats_cx_tx_segments_total",
              "legend": "TX Segments: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_rx_segments_total",
              "legend": "RX Segments: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_tx_data_segments_total",
              "legend": "TX Data Segments: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_rx_data_segments_total",
              "legend": "RX Data Segments: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "TCP Data & Retransmissions",
          "description": "TCP data and retransmission statistics",
          "metric_names": [
            "cluster_tcp_stats_cx_tx_retransmitted_segments_total",
            "cluster_tcp_stats_cx_rx_bytes_received_total",
            "cluster_tcp_stats_cx_tx_bytes_sent_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_tcp_stats_cx_tx_retransmitted_segments_total",
              "legend": "Retransmitted Segments: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_rx_bytes_received_total",
              "legend": "Bytes Received: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_tx_bytes_sent_total",
              "legend": "Bytes Sent: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "TCP Queue & Unacked",
          "description": "TCP queue and unacknowledged segments statistics",
          "metric_names": [
            "cluster_tcp_stats_cx_tx_unsent_bytes",
            "cluster_tcp_stats_cx_tx_unacked_segments"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_tcp_stats_cx_tx_unsent_bytes",
              "legend": "Unsent Bytes: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_tx_unacked_segments",
              "legend": "Unacked Segments: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "TCP Retransmission Rate",
          "description": "TCP retransmission rate histogram",
          "metric_names": [
            "cluster_tcp_stats_cx_tx_percent_retransmitted_segments_bucket"
          ],
          "unit": "percent",
          "queries": [
            {
              "metric": "cluster_tcp_stats_cx_tx_percent_retransmitted_segments_bucket",
              "legend": "Retransmitted % (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_tx_percent_retransmitted_segments_bucket",
              "legend": "Retransmitted % (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_tx_percent_retransmitted_segments_bucket",
              "legend": "Retransmitted % (p90): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.90,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_tx_percent_retransmitted_segments_bucket",
              "legend": "Retransmitted % (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "TCP Latency & Variance",
          "description": "TCP latency and variance histograms",
          "metric_names": [
            "cluster_tcp_stats_cx_rtt_us_bucket",
            "cluster_tcp_stats_cx_rtt_variance_us_bucket"
          ],
          "unit": "s",
          "queries": [
            {
              "metric": "cluster_tcp_stats_cx_rtt_us_bucket",
              "legend": "RTT (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_rtt_us_bucket",
              "legend": "RTT (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_rtt_us_bucket",
              "legend": "RTT (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_rtt_variance_us_bucket",
              "legend": "RTT Variance (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_tcp_stats_cx_rtt_variance_us_bucket",
              "legend": "RTT Variance (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Load Balancer Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "LB Zone Routing",
          "description": "Load Balancer zone routing statistics",
          "metric_names": [
            "cluster_lb_recalculate_zone_structures_total",
            "cluster_lb_zone_routing_all_directly_total",
            "cluster_lb_zone_routing_sampled_total",
            "cluster_lb_zone_routing_cross_zone_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_lb_recalculate_zone_structures_total",
              "legend": "Recalculate Zone Structures: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_zone_routing_all_directly_total",
              "legend": "Zone Routing All Directly: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_zone_routing_sampled_total",
              "legend": "Zone Routing Sampled: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_zone_routing_cross_zone_total",
              "legend": "Zone Routing Cross Zone: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "LB Errors & Panic",
          "description": "Load Balancer errors and panic mode statistics",
          "metric_names": [
            "cluster_lb_healthy_panic_total",
            "cluster_lb_zone_cluster_too_small_total",
            "cluster_lb_local_cluster_not_ok_total",
            "cluster_lb_zone_no_capacity_left_total",
            "cluster_original_dst_host_invalid_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_lb_healthy_panic_total",
              "legend": "Healthy Panic: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_zone_cluster_too_small_total",
              "legend": "Zone Cluster Too Small: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_local_cluster_not_ok_total",
              "legend": "Local Cluster Not OK: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_zone_no_capacity_left_total",
              "legend": "Zone No Capacity Left: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_original_dst_host_invalid_total",
              "legend": "Original Dst Host Invalid: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Load Balancer Subset Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "LB Subset Status",
          "description": "Load Balancer subset status statistics",
          "metric_names": [
            "cluster_lb_subsets_active",
            "cluster_lb_subsets_created_total",
            "cluster_lb_subsets_removed_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_lb_subsets_active",
              "legend": "Active Subsets: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_subsets_created_total",
              "legend": "Subsets Created: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_subsets_removed_total",
              "legend": "Subsets Removed: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "LB Subset Selection & Fallback",
          "description": "Load Balancer subset selection and fallback statistics",
          "metric_names": [
            "cluster_lb_subsets_selected_total",
            "cluster_lb_subsets_fallback_total",
            "cluster_lb_subsets_fallback_panic_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_lb_subsets_selected_total",
              "legend": "Subsets Selected: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_subsets_fallback_total",
              "legend": "Fallback Invoked: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_lb_subsets_fallback_panic_total",
              "legend": "Fallback Panic: {{envoy_cluster_name}}",
              "type": "rate",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "LB Subset Duplicates",
          "description": "Load Balancer subset duplicate hosts statistics",
          "metric_names": [
            "cluster_lb_subsets_single_host_per_subset_duplicate"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_lb_subsets_single_host_per_subset_duplicate",
              "legend": "Duplicate Hosts: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Ring Hash LB Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Ring Hash Distribution",
          "description": "Ring Hash load balancer distribution statistics",
          "metric_names": [
            "cluster_ring_hash_lb_size",
            "cluster_ring_hash_lb_min_hashes_per_host",
            "cluster_ring_hash_lb_max_hashes_per_host"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_ring_hash_lb_size",
              "legend": "Ring Size: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ring_hash_lb_min_hashes_per_host",
              "legend": "Min Hashes Per Host: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_ring_hash_lb_max_hashes_per_host",
              "legend": "Max Hashes Per Host: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Maglev LB Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Maglev Distribution",
          "description": "Maglev load balancer distribution statistics",
          "metric_names": [
            "cluster_maglev_lb_min_entries_per_host",
            "cluster_maglev_lb_max_entries_per_host"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "cluster_maglev_lb_min_entries_per_host",
              "legend": "Min Entries Per Host: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_maglev_lb_max_entries_per_host",
              "legend": "Max Entries Per Host: {{envoy_cluster_name}}",
              "type": "gauge",
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Upstream - Request/Response Size Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Request Size",
          "description": "Request size statistics (headers, header count, body)",
          "metric_names": [
            "cluster_upstream_rq_headers_size_bucket",
            "cluster_upstream_rq_headers_count_bucket",
            "cluster_upstream_rq_body_size_bucket"
          ],
          "unit": "bytes",
          "queries": [
            {
              "metric": "cluster_upstream_rq_headers_size_bucket",
              "legend": "Headers Size (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_headers_size_bucket",
              "legend": "Headers Size (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_headers_size_bucket",
              "legend": "Headers Size (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_headers_count_bucket",
              "legend": "Headers Count (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_headers_count_bucket",
              "legend": "Headers Count (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_headers_count_bucket",
              "legend": "Headers Count (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_body_size_bucket",
              "legend": "Body Size (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_body_size_bucket",
              "legend": "Body Size (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rq_body_size_bucket",
              "legend": "Body Size (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        },
        {
          "title": "Response Size",
          "description": "Response size statistics (headers, header count, body)",
          "metric_names": [
            "cluster_upstream_rs_headers_size_bucket",
            "cluster_upstream_rs_headers_count_bucket",
            "cluster_upstream_rs_body_size_bucket"
          ],
          "unit": "bytes",
          "queries": [
            {
              "metric": "cluster_upstream_rs_headers_size_bucket",
              "legend": "Headers Size (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rs_headers_size_bucket",
              "legend": "Headers Size (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rs_headers_size_bucket",
              "legend": "Headers Size (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rs_headers_count_bucket",
              "legend": "Headers Count (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rs_headers_count_bucket",
              "legend": "Headers Count (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rs_headers_count_bucket",
              "legend": "Headers Count (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rs_body_size_bucket",
              "legend": "Body Size (p99): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rs_body_size_bucket",
              "legend": "Body Size (p95): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            },
            {
              "metric": "cluster_upstream_rs_body_size_bucket",
              "legend": "Body Size (p50): {{envoy_cluster_name}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_cluster_name",
              "exclude_cluster": "elchi-control-plane"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Listener",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Listener Connections",
          "description": "Total, active, and destroyed listener connections",
          "metric_names": [
            "listener_downstream_cx_total",
            "listener_downstream_cx_active",
            "listener_downstream_cx_destroy_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_downstream_cx_total",
              "legend": "Total: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_downstream_cx_active",
              "legend": "Active: {{envoy_listener_address}}",
              "type": "gauge",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_downstream_cx_destroy_total",
              "legend": "Destroyed: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "Connection Overflow & Limits",
          "description": "Connections rejected due to limits and overload",
          "metric_names": [
            "listener_downstream_cx_overflow_total",
            "listener_downstream_global_cx_overflow_total",
            "listener_downstream_cx_overload_reject_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_downstream_cx_overflow_total",
              "legend": "Listener Overflow: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_downstream_global_cx_overflow_total",
              "legend": "Global Overflow: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_downstream_cx_overload_reject_total",
              "legend": "Overload Reject: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "Connection Timeouts",
          "description": "Connection timeouts during transport and filter processing",
          "metric_names": [
            "listener_downstream_cx_transport_socket_connect_timeout_total",
            "listener_downstream_pre_cx_timeout_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_downstream_cx_transport_socket_connect_timeout_total",
              "legend": "Transport Timeout: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_downstream_pre_cx_timeout_total",
              "legend": "Pre-Cx Timeout: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "Listener Filter Processing",
          "description": "Active connections in listener filter processing",
          "metric_names": [
            "listener_downstream_pre_cx_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_downstream_pre_cx_active",
              "legend": "Pre-Cx Active: {{envoy_listener_address}}",
              "type": "gauge",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "Filter Configuration Errors",
          "description": "Connections closed due to missing filter configurations",
          "metric_names": [
            "listener_extension_config_missing_total",
            "listener_network_extension_config_missing_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_extension_config_missing_total",
              "legend": "Listener Extension Missing: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_network_extension_config_missing_total",
              "legend": "Network Extension Missing: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "Filter Chain & Remote Close",
          "description": "Filter chain mismatches and remote close events",
          "metric_names": [
            "listener_no_filter_chain_match_total",
            "listener_downstream_listener_filter_remote_close_total",
            "listener_downstream_listener_filter_error_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_no_filter_chain_match_total",
              "legend": "No Chain Match: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_downstream_listener_filter_remote_close_total",
              "legend": "Remote Close: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_downstream_listener_filter_error_total",
              "legend": "Filter Error: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "Connection Length",
          "description": "Distribution of connection durations",
          "metric_names": [
            "listener_downstream_cx_length_ms_bucket"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": "listener_downstream_cx_length_ms_bucket",
              "legend": "Length (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_downstream_cx_length_ms_bucket",
              "legend": "Length (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_downstream_cx_length_ms_bucket",
              "legend": "Length (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "Connections Per Socket Event",
          "description": "Distribution of connections accepted per socket event",
          "metric_names": [
            "listener_connections_accepted_per_socket_event_bucket"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_connections_accepted_per_socket_event_bucket",
              "legend": "Accepted (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_connections_accepted_per_socket_event_bucket",
              "legend": "Accepted (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_connections_accepted_per_socket_event_bucket",
              "legend": "Accepted (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Listener - TLS Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "TLS Handshakes & Errors",
          "description": "TLS handshakes and connection errors",
          "metric_names": [
            "listener_ssl_handshake_total",
            "listener_ssl_connection_error_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_ssl_handshake_total",
              "legend": "Handshake: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_ssl_connection_error_total",
              "legend": "Error: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "TLS Session Reuse",
          "description": "Successful TLS session resumptions",
          "metric_names": [
            "listener_ssl_session_reused_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_ssl_session_reused_total",
              "legend": "Session Reused: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "Client Certificate Status",
          "description": "Connections with or without client certificates",
          "metric_names": [
            "listener_ssl_no_certificate_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_ssl_no_certificate_total",
              "legend": "No Certificate: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "Certificate Verification Failures",
          "description": "Failed certificate verifications by type",
          "metric_names": [
            "listener_ssl_fail_verify_no_cert_total",
            "listener_ssl_fail_verify_error_total",
            "listener_ssl_fail_verify_san_total",
            "listener_ssl_fail_verify_cert_hash_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_ssl_fail_verify_no_cert_total",
              "legend": "No Cert: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_ssl_fail_verify_error_total",
              "legend": "CA Error: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_ssl_fail_verify_san_total",
              "legend": "SAN Failed: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_ssl_fail_verify_cert_hash_total",
              "legend": "Cert Hash Failed: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "OCSP Stapling",
          "description": "OCSP stapling statistics",
          "metric_names": [
            "listener_ssl_ocsp_staple_failed_total",
            "listener_ssl_ocsp_staple_omitted_total",
            "listener_ssl_ocsp_staple_responses_total",
            "listener_ssl_ocsp_staple_requests_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_ssl_ocsp_staple_failed_total",
              "legend": "Failed: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_ssl_ocsp_staple_omitted_total",
              "legend": "Omitted: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_ssl_ocsp_staple_responses_total",
              "legend": "Responses: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_ssl_ocsp_staple_requests_total",
              "legend": "Requests: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "TLS Ciphers",
          "description": "Successful connections by cipher",
          "metric_names": [
            "listener_ssl_ciphers_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_ssl_ciphers_total",
              "legend": "{{envoy_ssl_cipher}}: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address,envoy_ssl_cipher"
            }
          ]
        },
        {
          "title": "TLS Protocol Versions",
          "description": "Successful connections by TLS version",
          "metric_names": [
            "listener_ssl_versions_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_ssl_versions_total",
              "legend": "{{envoy_ssl_version}}: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address,envoy_ssl_version"
            }
          ]
        },
        {
          "title": "TLS Curves & Signature Algorithms",
          "description": "ECDHE curves and signature algorithms used",
          "metric_names": [
            "listener_ssl_curves_total",
            "listener_ssl_sigalgs_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_ssl_curves_total",
              "legend": "Curve {{envoy_ssl_curve}}: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address,envoy_ssl_curve"
            },
            {
              "metric": "listener_ssl_sigalgs_total",
              "legend": "SigAlg {{envoy_ssl_sigalg}}: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address,envoy_ssl_sigalg"
            }
          ]
        },
        {
          "title": "Invalid Key Usage",
          "description": "Connections with invalid keyUsage extension",
          "metric_names": [
            "listener_ssl_was_key_usage_invalid_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_ssl_was_key_usage_invalid_total",
              "legend": "Invalid Key Usage: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Listener - TCP Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "TCP Segments",
          "description": "Total TCP segments transmitted and received",
          "metric_names": [
            "listener_tcp_stats_cx_tx_segments_total",
            "listener_tcp_stats_cx_rx_segments_total",
            "listener_tcp_stats_cx_tx_data_segments_total",
            "listener_tcp_stats_cx_rx_data_segments_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_tcp_stats_cx_tx_segments_total",
              "legend": "TX Segments: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_rx_segments_total",
              "legend": "RX Segments: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_tx_data_segments_total",
              "legend": "TX Data Segments: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_rx_data_segments_total",
              "legend": "RX Data Segments: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "TCP Retransmissions",
          "description": "Retransmitted TCP segments",
          "metric_names": [
            "listener_tcp_stats_cx_tx_retransmitted_segments_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_tcp_stats_cx_tx_retransmitted_segments_total",
              "legend": "Retransmitted: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "TCP Bytes Transferred",
          "description": "Payload bytes sent and received",
          "metric_names": [
            "listener_tcp_stats_cx_tx_bytes_sent_total",
            "listener_tcp_stats_cx_rx_bytes_received_total"
          ],
          "unit": "bytes",
          "queries": [
            {
              "metric": "listener_tcp_stats_cx_tx_bytes_sent_total",
              "legend": "TX Bytes: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_rx_bytes_received_total",
              "legend": "RX Bytes: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "TCP Buffer Status",
          "description": "Unsent bytes and unacknowledged segments",
          "metric_names": [
            "listener_tcp_stats_cx_tx_unsent_bytes",
            "listener_tcp_stats_cx_tx_unacked_segments"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_tcp_stats_cx_tx_unsent_bytes",
              "legend": "Unsent Bytes: {{envoy_listener_address}}",
              "type": "gauge",
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_tx_unacked_segments",
              "legend": "Unacked Segments: {{envoy_listener_address}}",
              "type": "gauge",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "TCP Retransmit Percentage",
          "description": "Percent of segments retransmitted",
          "metric_names": [
            "listener_tcp_stats_cx_tx_percent_retransmitted_segments_bucket"
          ],
          "unit": "percent",
          "queries": [
            {
              "metric": "listener_tcp_stats_cx_tx_percent_retransmitted_segments_bucket",
              "legend": "Retransmit % (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_tx_percent_retransmitted_segments_bucket",
              "legend": "Retransmit % (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_tx_percent_retransmitted_segments_bucket",
              "legend": "Retransmit % (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "TCP Round Trip Time (RTT)",
          "description": "Smoothed RTT estimate in microseconds",
          "metric_names": [
            "listener_tcp_stats_cx_rtt_us_bucket"
          ],
          "unit": "s",
          "queries": [
            {
              "metric": "listener_tcp_stats_cx_rtt_us_bucket",
              "legend": "RTT (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_rtt_us_bucket",
              "legend": "RTT (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_rtt_us_bucket",
              "legend": "RTT (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "TCP RTT Variance",
          "description": "Estimated variance of round trip time",
          "metric_names": [
            "listener_tcp_stats_cx_rtt_variance_us_bucket"
          ],
          "unit": "s",
          "queries": [
            {
              "metric": "listener_tcp_stats_cx_rtt_variance_us_bucket",
              "legend": "RTT Variance (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_rtt_variance_us_bucket",
              "legend": "RTT Variance (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_tcp_stats_cx_rtt_variance_us_bucket",
              "legend": "RTT Variance (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Listener - QUIC Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "QUIC Packets Transmitted",
          "description": "Total QUIC packets transmitted per listener",
          "metric_names": [
            "listener_quic_stats_cx_tx_packets_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_tx_packets_total",
              "legend": "TX: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC Packets Received",
          "description": "Total QUIC packets received per listener",
          "metric_names": [
            "listener_quic_stats_cx_rx_packets_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_rx_packets_total",
              "legend": "RX: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC Packets Retransmitted",
          "description": "Total QUIC packets retransmitted per listener",
          "metric_names": [
            "listener_quic_stats_cx_tx_packets_retransmitted_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_tx_packets_retransmitted_total",
              "legend": "Retransmitted: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC Amplification Throttling",
          "description": "Number of packets throttled during server handshake response - indicates TLS certificate chain may be too long",
          "metric_names": [
            "listener_quic_stats_cx_tx_amplification_throttling_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_tx_amplification_throttling_total",
              "legend": "Throttled: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC Path Degradation",
          "description": "Number of times network path degradation was detected",
          "metric_names": [
            "listener_quic_stats_cx_path_degrading_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_path_degrading_total",
              "legend": "Degraded: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC Path Recovery",
          "description": "Number of times forward progress was made after path degradation",
          "metric_names": [
            "listener_quic_stats_cx_forward_progress_after_path_degrading_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_forward_progress_after_path_degrading_total",
              "legend": "Recovered: {{envoy_listener_address}}",
              "type": "rate",
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC Round Trip Time",
          "description": "Smoothed round trip time estimate in microseconds",
          "metric_names": [
            "listener_quic_stats_cx_rtt_us_bucket"
          ],
          "unit": "s",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_rtt_us_bucket",
              "legend": "RTT (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_rtt_us_bucket",
              "legend": "RTT (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_rtt_us_bucket",
              "legend": "RTT (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC Estimated Bandwidth",
          "description": "Estimated connection bandwidth in bytes per second",
          "metric_names": [
            "listener_quic_stats_cx_tx_estimated_bandwidth_bucket"
          ],
          "unit": "Bps",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_tx_estimated_bandwidth_bucket",
              "legend": "Bandwidth (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_tx_estimated_bandwidth_bucket",
              "legend": "Bandwidth (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_tx_estimated_bandwidth_bucket",
              "legend": "Bandwidth (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC Retransmitted Packets Percentage",
          "description": "Percentage of packets retransmitted on a connection",
          "metric_names": [
            "listener_quic_stats_cx_tx_percent_retransmitted_packets_bucket"
          ],
          "unit": "percent",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_tx_percent_retransmitted_packets_bucket",
              "legend": "% Retransmitted (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_tx_percent_retransmitted_packets_bucket",
              "legend": "% Retransmitted (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_tx_percent_retransmitted_packets_bucket",
              "legend": "% Retransmitted (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC TX MTU Size",
          "description": "Maximum transmission unit size for packets sent",
          "metric_names": [
            "listener_quic_stats_cx_tx_mtu_bucket"
          ],
          "unit": "bytes",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_tx_mtu_bucket",
              "legend": "TX MTU (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_tx_mtu_bucket",
              "legend": "TX MTU (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_tx_mtu_bucket",
              "legend": "TX MTU (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        },
        {
          "title": "QUIC RX MTU Size",
          "description": "Size of the largest packet received from peer",
          "metric_names": [
            "listener_quic_stats_cx_rx_mtu_bucket"
          ],
          "unit": "bytes",
          "queries": [
            {
              "metric": "listener_quic_stats_cx_rx_mtu_bucket",
              "legend": "RX MTU (p99): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.99,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_rx_mtu_bucket",
              "legend": "RX MTU (p95): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.95,
              "group_by": "envoy_listener_address"
            },
            {
              "metric": "listener_quic_stats_cx_rx_mtu_bucket",
              "legend": "RX MTU (p50): {{envoy_listener_address}}",
              "type": "histogram",
              "quantile": 0.50,
              "group_by": "envoy_listener_address"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Listener Manager",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Listener Lifecycle Operations",
          "description": "Listener add, modify, remove, and stop operations",
          "metric_names": [
            "listener_manager_listener_added_total",
            "listener_manager_listener_modified_total",
            "listener_manager_listener_removed_total",
            "listener_manager_listener_stopped_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "listener_manager_listener_added_total",
              "legend": "Added",
              "type": "rate"
            },
            {
              "metric": "listener_manager_listener_modified_total",
              "legend": "Modified",
              "type": "rate"
            },
            {
              "metric": "listener_manager_listener_removed_total",
              "legend": "Removed",
              "type": "rate"
            },
            {
              "metric": "listener_manager_listener_stopped_total",
              "legend": "Stopped",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Listener Creation Status",
          "description": "Success and failure rates for listener creation",
          "metric_names": [
            "listener_manager_listener_create_success_total",
            "listener_manager_listener_create_failure_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "listener_manager_listener_create_success_total",
              "legend": "Success",
              "type": "rate"
            },
            {
              "metric": "listener_manager_listener_create_failure_total",
              "legend": "Failure",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Listener In-Place Updates",
          "description": "Number of listener objects updated in place",
          "metric_names": [
            "listener_manager_listener_in_place_updated_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "listener_manager_listener_in_place_updated_total",
              "legend": "In-Place Updated",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Filter Chains Draining",
          "description": "Total filter chains currently draining",
          "metric_names": [
            "listener_manager_total_filter_chains_draining"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_manager_total_filter_chains_draining",
              "legend": "Filter Chains Draining",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "Listener States",
          "description": "Current count of listeners in warming, active, and draining states",
          "metric_names": [
            "listener_manager_total_listeners_warming",
            "listener_manager_total_listeners_active",
            "listener_manager_total_listeners_draining"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_manager_total_listeners_warming",
              "legend": "Warming",
              "type": "gauge"
            },
            {
              "metric": "listener_manager_total_listeners_active",
              "legend": "Active",
              "type": "gauge"
            },
            {
              "metric": "listener_manager_total_listeners_draining",
              "legend": "Draining",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "Workers Started",
          "description": "Indicates if workers have been started on the listeners",
          "metric_names": [
            "listener_manager_workers_started"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "listener_manager_workers_started",
              "legend": "Workers Started",
              "type": "gauge"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Network Filters - Client TLS Authentication",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Principal Update Operations",
          "description": "Success and failure rates for principal updates",
          "metric_names": [
            "auth_clientssl_update_success_total",
            "auth_clientssl_update_failure_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "auth_clientssl_update_success_total",
              "legend": "Success",
              "type": "rate"
            },
            {
              "metric": "auth_clientssl_update_failure_total",
              "legend": "Failure",
              "type": "rate"
            }
          ]
        },
        {
          "title": "TLS Authentication Decisions",
          "description": "Connection authentication outcomes - no SSL, IP allowlist, digest match/no match",
          "metric_names": [
            "auth_clientssl_auth_no_ssl_total",
            "auth_clientssl_auth_ip_allowlist_total",
            "auth_clientssl_auth_digest_match_total",
            "auth_clientssl_auth_digest_no_match_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "auth_clientssl_auth_no_ssl_total",
              "legend": "No SSL",
              "type": "rate"
            },
            {
              "metric": "auth_clientssl_auth_ip_allowlist_total",
              "legend": "IP Allowlist",
              "type": "rate"
            },
            {
              "metric": "auth_clientssl_auth_digest_match_total",
              "legend": "Digest Match",
              "type": "rate"
            },
            {
              "metric": "auth_clientssl_auth_digest_no_match_total",
              "legend": "Digest No Match",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Total Loaded Principals",
          "description": "Current number of loaded principals for TLS authentication",
          "metric_names": [
            "auth_clientssl_total_principals"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "auth_clientssl_total_principals",
              "legend": "Total Principals",
              "type": "gauge"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Network Filters - Connection Limit",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Limited Connections",
          "description": "Rate of connections rejected due to connection limit exceeded",
          "metric_names": [
            "connection_limit_limited_connections_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "connection_limit_limited_connections_total",
              "legend": "Limited Connections",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Active Connections",
          "description": "Current number of active connections in the scope of this network filter chain",
          "metric_names": [
            "connection_limit_active_connections"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "connection_limit_active_connections",
              "legend": "Active Connections",
              "type": "gauge"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Network Filters - External Authorization",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Authorization Responses",
          "description": "Total responses from the external authorization service",
          "metric_names": [
            "config_ext_authz_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "config_ext_authz_total",
              "legend": "Total Responses",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Authorization Decisions",
          "description": "Authorization service decisions - OK, denied, disabled",
          "metric_names": [
            "config_ext_authz_ok_total",
            "config_ext_authz_denied_total",
            "config_ext_authz_disabled_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "config_ext_authz_ok_total",
              "legend": "OK",
              "type": "rate"
            },
            {
              "metric": "config_ext_authz_denied_total",
              "legend": "Denied",
              "type": "rate"
            },
            {
              "metric": "config_ext_authz_disabled_total",
              "legend": "Disabled",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Authorization Errors & Failures",
          "description": "Errors contacting external service and failure mode allowed requests",
          "metric_names": [
            "config_ext_authz_error_total",
            "config_ext_authz_failure_mode_allowed_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "config_ext_authz_error_total",
              "legend": "Error",
              "type": "rate"
            },
            {
              "metric": "config_ext_authz_failure_mode_allowed_total",
              "legend": "Failure Mode Allowed",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Authorization Connection Status",
          "description": "Closed connections and currently active requests",
          "metric_names": [
            "config_ext_authz_cx_closed_total",
            "config_ext_authz_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "config_ext_authz_cx_closed_total",
              "legend": "Closed Connections",
              "type": "rate"
            },
            {
              "metric": "config_ext_authz_active",
              "legend": "Active Requests",
              "type": "gauge"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Network Filters - Local Rate Limit",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Rate Limited Connections",
          "description": "Total connections closed due to rate limit exceeded",
          "metric_names": [
            "local_ratelimit_rate_limited_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "local_ratelimit_rate_limited_total",
              "legend": "Rate Limited",
              "type": "rate"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Network Filters - MongoDB Proxy",
      "is_collapsed": true,
      "panels": [
        {
          "title": "MongoDB Protocol Errors",
          "description": "MongoDB protocol decoding errors and delay injections",
          "metric_names": [
            "mongo_decoding_error_total",
            "mongo_delay_injected_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "mongo_decoding_error_total",
              "legend": "Decoding Error",
              "type": "rate"
            },
            {
              "metric": "mongo_delay_injected_total",
              "legend": "Delay Injected",
              "type": "rate"
            }
          ]
        },
        {
          "title": "MongoDB Operations",
          "description": "Rate of MongoDB operations by type",
          "metric_names": [
            "mongo_op_insert_total",
            "mongo_op_query_total",
            "mongo_op_get_more_total",
            "mongo_op_kill_cursors_total",
            "mongo_op_reply_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "mongo_op_insert_total",
              "legend": "OP_INSERT",
              "type": "rate"
            },
            {
              "metric": "mongo_op_query_total",
              "legend": "OP_QUERY",
              "type": "rate"
            },
            {
              "metric": "mongo_op_get_more_total",
              "legend": "OP_GET_MORE",
              "type": "rate"
            },
            {
              "metric": "mongo_op_kill_cursors_total",
              "legend": "OP_KILL_CURSORS",
              "type": "rate"
            },
            {
              "metric": "mongo_op_reply_total",
              "legend": "OP_REPLY",
              "type": "rate"
            }
          ]
        },
        {
          "title": "MongoDB Query Flags",
          "description": "OP_QUERY messages with various flags set",
          "metric_names": [
            "mongo_op_query_tailable_cursor_total",
            "mongo_op_query_no_cursor_timeout_total",
            "mongo_op_query_await_data_total",
            "mongo_op_query_exhaust_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "mongo_op_query_tailable_cursor_total",
              "legend": "Tailable Cursor",
              "type": "rate"
            },
            {
              "metric": "mongo_op_query_no_cursor_timeout_total",
              "legend": "No Cursor Timeout",
              "type": "rate"
            },
            {
              "metric": "mongo_op_query_await_data_total",
              "legend": "Await Data",
              "type": "rate"
            },
            {
              "metric": "mongo_op_query_exhaust_total",
              "legend": "Exhaust",
              "type": "rate"
            }
          ]
        },
        {
          "title": "MongoDB Query Types",
          "description": "Query types and active queries",
          "metric_names": [
            "mongo_op_query_no_max_time_total",
            "mongo_op_query_scatter_get_total",
            "mongo_op_query_multi_get_total",
            "mongo_op_query_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "mongo_op_query_no_max_time_total",
              "legend": "No MaxTime",
              "type": "rate"
            },
            {
              "metric": "mongo_op_query_scatter_get_total",
              "legend": "Scatter Get",
              "type": "rate"
            },
            {
              "metric": "mongo_op_query_multi_get_total",
              "legend": "Multi Get",
              "type": "rate"
            },
            {
              "metric": "mongo_op_query_active",
              "legend": "Active Queries",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "MongoDB Reply Status",
          "description": "OP_REPLY messages with various status flags",
          "metric_names": [
            "mongo_op_reply_cursor_not_found_total",
            "mongo_op_reply_query_failure_total",
            "mongo_op_reply_valid_cursor_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "mongo_op_reply_cursor_not_found_total",
              "legend": "Cursor Not Found",
              "type": "rate"
            },
            {
              "metric": "mongo_op_reply_query_failure_total",
              "legend": "Query Failure",
              "type": "rate"
            },
            {
              "metric": "mongo_op_reply_valid_cursor_total",
              "legend": "Valid Cursor",
              "type": "rate"
            }
          ]
        },
        {
          "title": "MongoDB Connection Management",
          "description": "Connection destruction with active queries and graceful drain closes",
          "metric_names": [
            "mongo_cx_destroy_local_with_active_rq_total",
            "mongo_cx_destroy_remote_with_active_rq_total",
            "mongo_cx_drain_close_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "mongo_cx_destroy_local_with_active_rq_total",
              "legend": "Destroy Local (Active Query)",
              "type": "rate"
            },
            {
              "metric": "mongo_cx_destroy_remote_with_active_rq_total",
              "legend": "Destroy Remote (Active Query)",
              "type": "rate"
            },
            {
              "metric": "mongo_cx_drain_close_total",
              "legend": "Drain Close",
              "type": "rate"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Network Filters - RBAC",
      "is_collapsed": true,
      "panels": [
        {
          "title": "RBAC Access Decisions",
          "description": "Total requests allowed and denied by RBAC filter",
          "metric_names": [
            "rbac_allowed_total",
            "rbac_denied_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "rbac_allowed_total",
              "legend": "Allowed",
              "type": "rate"
            },
            {
              "metric": "rbac_denied_total",
              "legend": "Denied",
              "type": "rate"
            }
          ]
        },
        {
          "title": "RBAC Shadow Rules",
          "description": "Requests that would be allowed/denied by shadow rules",
          "metric_names": [
            "rbac_shadow_allowed_total",
            "rbac_shadow_denied_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "rbac_shadow_allowed_total",
              "legend": "Shadow Allowed",
              "type": "rate"
            },
            {
              "metric": "rbac_shadow_denied_total",
              "legend": "Shadow Denied",
              "type": "rate"
            }
          ]
        },
        {
          "title": "RBAC Logging Decisions",
          "description": "Requests that should/should not be logged",
          "metric_names": [
            "rbac_logged_total",
            "rbac_not_logged_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "rbac_logged_total",
              "legend": "Logged",
              "type": "rate"
            },
            {
              "metric": "rbac_not_logged_total",
              "legend": "Not Logged",
              "type": "rate"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Network Filters - TCP Proxy",
      "is_collapsed": true,
      "panels": [
        {
          "title": "TCP Downstream Connections",
          "description": "Total connections handled and connections with no route",
          "metric_names": [
            "tcp_downstream_cx_total",
            "tcp_downstream_cx_no_route_total"
          ],
          "unit": "cps",
          "queries": [
            {
              "metric": "tcp_downstream_cx_total",
              "legend": "Total Connections",
              "type": "rate"
            },
            {
              "metric": "tcp_downstream_cx_no_route_total",
              "legend": "No Route",
              "type": "rate"
            }
          ]
        },
        {
          "title": "TCP Downstream Bytes Transmitted",
          "description": "Total and buffered bytes written to downstream",
          "metric_names": [
            "tcp_downstream_cx_tx_bytes_total",
            "tcp_downstream_cx_tx_bytes_buffered"
          ],
          "unit": "Bps",
          "queries": [
            {
              "metric": "tcp_downstream_cx_tx_bytes_total",
              "legend": "TX Total",
              "type": "rate"
            },
            {
              "metric": "tcp_downstream_cx_tx_bytes_buffered",
              "legend": "TX Buffered",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "TCP Downstream Bytes Received",
          "description": "Total and buffered bytes read from downstream",
          "metric_names": [
            "tcp_downstream_cx_rx_bytes_total",
            "tcp_downstream_cx_rx_bytes_buffered"
          ],
          "unit": "Bps",
          "queries": [
            {
              "metric": "tcp_downstream_cx_rx_bytes_total",
              "legend": "RX Total",
              "type": "rate"
            },
            {
              "metric": "tcp_downstream_cx_rx_bytes_buffered",
              "legend": "RX Buffered",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "TCP Flow Control",
          "description": "Flow control paused and resumed reading from downstream",
          "metric_names": [
            "tcp_downstream_flow_control_paused_reading_total",
            "tcp_downstream_flow_control_resumed_reading_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "tcp_downstream_flow_control_paused_reading_total",
              "legend": "Paused Reading",
              "type": "rate"
            },
            {
              "metric": "tcp_downstream_flow_control_resumed_reading_total",
              "legend": "Resumed Reading",
              "type": "rate"
            }
          ]
        },
        {
          "title": "TCP Connection Timeouts",
          "description": "Connections closed due to idle timeout and max duration",
          "metric_names": [
            "tcp_idle_timeout_total",
            "tcp_max_downstream_connection_duration_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "tcp_idle_timeout_total",
              "legend": "Idle Timeout",
              "type": "rate"
            },
            {
              "metric": "tcp_max_downstream_connection_duration_total",
              "legend": "Max Duration",
              "type": "rate"
            }
          ]
        },
        {
          "title": "TCP On-Demand Cluster",
          "description": "On-demand cluster requests and their outcomes",
          "metric_names": [
            "tcp_on_demand_cluster_attempt_total",
            "tcp_on_demand_cluster_success_total",
            "tcp_on_demand_cluster_missing_total",
            "tcp_on_demand_cluster_timeout_total"
          ],
          "unit": "ops",
          "queries": [
            {
              "metric": "tcp_on_demand_cluster_attempt_total",
              "legend": "Attempt",
              "type": "rate"
            },
            {
              "metric": "tcp_on_demand_cluster_success_total",
              "legend": "Success",
              "type": "rate"
            },
            {
              "metric": "tcp_on_demand_cluster_missing_total",
              "legend": "Missing",
              "type": "rate"
            },
            {
              "metric": "tcp_on_demand_cluster_timeout_total",
              "legend": "Timeout",
              "type": "rate"
            }
          ]
        },
        {
          "title": "TCP Upstream Flush & Early Data",
          "description": "Upstream flush operations and early data received",
          "metric_names": [
            "tcp_upstream_flush_total",
            "tcp_upstream_flush_active",
            "tcp_early_data_received_count_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "tcp_upstream_flush_total",
              "legend": "Flush Total",
              "type": "rate"
            },
            {
              "metric": "tcp_upstream_flush_active",
              "legend": "Flush Active",
              "type": "gauge"
            },
            {
              "metric": "tcp_early_data_received_count_total",
              "legend": "Early Data Received",
              "type": "rate"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Adaptive Concurrency (Gradient Controller)",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Blocked Requests",
          "description": "Total requests blocked by the adaptive concurrency filter",
          "metric_names": [
            "http_adaptive_concurrency_gradient_controller_rq_blocked_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*adaptive_concurrency_gradient_controller_rq_blocked_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Min RTT Calculation Active",
          "description": "Indicates if the controller is calculating minimum RTT (1=active, 0=inactive)",
          "metric_names": [
            "http_adaptive_concurrency_gradient_controller_min_rtt_calculation_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*adaptive_concurrency_gradient_controller_min_rtt_calculation_active",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Concurrency Limit",
          "description": "Current concurrency limit enforced by the adaptive concurrency controller",
          "metric_names": [
            "http_adaptive_concurrency_gradient_controller_concurrency_limit"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*adaptive_concurrency_gradient_controller_concurrency_limit",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Gradient Value",
          "description": "Current gradient value (multiplied by 1000, ranges 500-2000)",
          "metric_names": [
            "http_adaptive_concurrency_gradient_controller_gradient"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*adaptive_concurrency_gradient_controller_gradient",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Burst Queue Size",
          "description": "Current headroom value in the concurrency limit calculation",
          "metric_names": [
            "http_adaptive_concurrency_gradient_controller_burst_queue_size"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*adaptive_concurrency_gradient_controller_burst_queue_size",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Minimum RTT",
          "description": "Current measured minimum round-trip time",
          "metric_names": [
            "http_adaptive_concurrency_gradient_controller_min_rtt_msecs"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": ".*adaptive_concurrency_gradient_controller_min_rtt_msecs",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Sample RTT",
          "description": "Current measured sample round-trip time aggregate",
          "metric_names": [
            "http_adaptive_concurrency_gradient_controller_sample_rtt_msecs"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": ".*adaptive_concurrency_gradient_controller_sample_rtt_msecs",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Admission Control",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Rejected Requests",
          "description": "Total requests that were not admitted by the filter",
          "metric_names": [
            "http_admission_control_rq_rejected_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*admission_control_rq_rejected_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Successful Requests",
          "description": "Total requests that were considered a success",
          "metric_names": [
            "http_admission_control_rq_success_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*admission_control_rq_success_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Failed Requests",
          "description": "Total requests that were considered a failure",
          "metric_names": [
            "http_admission_control_rq_failure_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*admission_control_rq_failure_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - API Key Auth",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Allowed Requests",
          "description": "Total number of requests allowed by the API key authentication filter",
          "metric_names": [
            "http_api_key_auth_allowed_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*api_key_auth_allowed_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Unauthorized Requests",
          "description": "Total number of requests with invalid API key",
          "metric_names": [
            "http_api_key_auth_unauthorized_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*api_key_auth_unauthorized_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Forbidden Requests",
          "description": "Total number of requests with valid API key but insufficient privileges",
          "metric_names": [
            "http_api_key_auth_forbidden_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*api_key_auth_forbidden_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Bandwidth Limit",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Request Bandwidth Limit - Counters",
          "description": "Request-side bandwidth limiter decisions and total transferred data",
          "metric_names": [
            "http_bandwidth_limit_request_enabled_total",
            "http_bandwidth_limit_request_enforced_total",
            "http_bandwidth_limit_request_incoming_total_size_total",
            "http_bandwidth_limit_request_allowed_total_size_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*http_bandwidth_limit_request_enabled_total",
              "legend": "Request Enabled",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_request_enforced_total",
              "legend": "Request Enforced",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_request_incoming_total_size_total",
              "legend": "Incoming Size Total",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_request_allowed_total_size_total",
              "legend": "Allowed Size Total",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Request Bandwidth Limit - Gauges",
          "description": "Current request pending streams and data sizes",
          "metric_names": [
            "http_bandwidth_limit_request_pending",
            "http_bandwidth_limit_request_incoming_size",
            "http_bandwidth_limit_request_allowed_size"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*http_bandwidth_limit_request_pending",
              "legend": "Request Pending",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_request_incoming_size",
              "legend": "Incoming Size",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_request_allowed_size",
              "legend": "Allowed Size",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Request Transfer Duration",
          "description": "Histogram of total transfer duration (including added delay)",
          "metric_names": [
            "http_bandwidth_limit_request_transfer_duration"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": ".*http_bandwidth_limit_request_transfer_duration",
              "legend": "Request Transfer Duration",
              "type": "histogram",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Response Bandwidth Limit - Counters",
          "description": "Response-side bandwidth limiter decisions and total transferred data",
          "metric_names": [
            "http_bandwidth_limit_response_enabled_total",
            "http_bandwidth_limit_response_enforced_total",
            "http_bandwidth_limit_response_incoming_total_size_total",
            "http_bandwidth_limit_response_allowed_total_size_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*http_bandwidth_limit_response_enabled_total",
              "legend": "Response Enabled",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_response_enforced_total",
              "legend": "Response Enforced",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_response_incoming_total_size_total",
              "legend": "Incoming Size Total",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_response_allowed_total_size_total",
              "legend": "Allowed Size Total",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Response Bandwidth Limit - Gauges",
          "description": "Current response pending streams and data sizes",
          "metric_names": [
            "http_bandwidth_limit_response_pending",
            "http_bandwidth_limit_response_incoming_size",
            "http_bandwidth_limit_response_allowed_size"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*http_bandwidth_limit_response_pending",
              "legend": "Response Pending",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_response_incoming_size",
              "legend": "Incoming Size",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_bandwidth_limit_response_allowed_size",
              "legend": "Allowed Size",
              "type": "gauge",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Response Transfer Duration",
          "description": "Histogram of total transfer duration for response streams",
          "metric_names": [
            "http_bandwidth_limit_response_transfer_duration"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": ".*http_bandwidth_limit_response_transfer_duration",
              "legend": "Response Transfer Duration",
              "type": "histogram",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Basic Auth",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Allowed Requests",
          "description": "Total number of requests allowed by the Basic Auth filter",
          "metric_names": [
            "http_basic_auth_allowed_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*basic_auth_allowed_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Denied Requests",
          "description": "Total number of requests denied by the Basic Auth filter",
          "metric_names": [
            "http_basic_auth_denied_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*basic_auth_denied_total",
              "legend": "{{envoy_http_conn_manager_prefix}}",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Compressor",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Compression Results",
          "description": "Compressed / uncompressed request counts and compression decisions",
          "metric_names": [
            "http_compressor_compressed_total",
            "http_compressor_not_compressed_total",
            "http_compressor_content_length_too_small_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*compressor.*compressed_total",
              "legend": "Compressed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*compressor.*not_compressed_total",
              "legend": "Not Compressed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*compressor.*content_length_too_small_total",
              "legend": "Content Too Small",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Compression Size Totals",
          "description": "Total uncompressed / compressed bytes handled by this filter",
          "metric_names": [
            "http_compressor_total_uncompressed_bytes_total",
            "http_compressor_total_compressed_bytes_total"
          ],
          "unit": "bytesps",
          "queries": [
            {
              "metric": ".*compressor.*total_uncompressed_bytes_total",
              "legend": "Uncompressed Bytes",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*compressor.*total_compressed_bytes_total",
              "legend": "Compressed Bytes",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Response Header Compression Stats",
          "description": "Response-only header-based compression decisions",
          "metric_names": [
            "http_compressor_no_accept_header_total",
            "http_compressor_header_identity_total",
            "http_compressor_header_compressor_used_total",
            "http_compressor_header_compressor_overshadowed_total",
            "http_compressor_header_wildcard_total",
            "http_compressor_header_not_valid_total",
            "http_compressor_not_compressed_etag_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*compressor.*no_accept_header_total",
              "legend": "No Accept Header",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*compressor.*header_identity_total",
              "legend": "Header: identity",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*compressor.*header_compressor_used_total",
              "legend": "Header: compressor used",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*compressor.*header_compressor_overshadowed_total",
              "legend": "Header: overshadowed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*compressor.*header_wildcard_total",
              "legend": "Header: wildcard",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*compressor.*header_not_valid_total",
              "legend": "Header: invalid",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*compressor.*not_compressed_etag_total",
              "legend": "Not Compressed: ETag",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - CORS",
      "is_collapsed": true,
      "panels": [
        {
          "title": "CORS Origin Validation",
          "description": "Valid and invalid Origin header counts for CORS requests",
          "metric_names": [
            "http_cors_origin_valid_total",
            "http_cors_origin_invalid_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*cors.*origin_valid_total",
              "legend": "Origin Valid",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*cors.*origin_invalid_total",
              "legend": "Origin Invalid",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Credential Injector",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Credential Injection",
          "description": "Core credential injection statistics",
          "metric_names": [
            "http_credential_injector_injected_total",
            "http_credential_injector_failed_total",
            "http_credential_injector_already_exists_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*credential_injector.*injected_total",
              "legend": "Injected",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*credential_injector.*failed_total",
              "legend": "Failed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*credential_injector.*already_exists_total",
              "legend": "Already Exists",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "OAuth2 Credential Injection",
          "description": "OAuth2 token fetching and credential injection failures",
          "metric_names": [
            "http_credential_injector_oauth2_token_requested_total",
            "http_credential_injector_oauth2_token_fetched_total",
            "http_credential_injector_oauth2_token_fetch_failed_on_client_secret_total",
            "http_credential_injector_oauth2_token_fetch_failed_on_cluster_not_found_total",
            "http_credential_injector_oauth2_token_fetch_failed_on_bad_response_code_total",
            "http_credential_injector_oauth2_token_fetch_failed_on_bad_token_total",
            "http_credential_injector_oauth2_token_fetch_failed_on_stream_reset_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*credential_injector.oauth2.*token_requested_total",
              "legend": "Token Requested",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*credential_injector.oauth2.*token_fetched_total",
              "legend": "Token Fetched",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*credential_injector.oauth2.*token_fetch_failed_on_client_secret_total",
              "legend": "Failed: Missing Client Secret",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*credential_injector.oauth2.*token_fetch_failed_on_cluster_not_found_total",
              "legend": "Failed: Cluster Not Found",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*credential_injector.oauth2.*token_fetch_failed_on_bad_response_code_total",
              "legend": "Failed: Bad Response Code",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*credential_injector.oauth2.*token_fetch_failed_on_bad_token_total",
              "legend": "Failed: Bad Token",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*credential_injector.oauth2.*token_fetch_failed_on_stream_reset_total",
              "legend": "Failed: Stream Reset",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - CSRF",
      "is_collapsed": true,
      "panels": [
        {
          "title": "CSRF Validation",
          "description": "Validation of source origin and matching target origins",
          "metric_names": [
            "http_csrf_missing_source_origin_total",
            "http_csrf_request_invalid_total",
            "http_csrf_request_valid_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*csrf.*missing_source_origin_total",
              "legend": "Missing Source Origin",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*csrf.*request_invalid_total",
              "legend": "Request Invalid",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*csrf.*request_valid_total",
              "legend": "Request Valid",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Ext Authz",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Authorization Outcomes",
          "description": "Responses and decisions from the external authorization service",
          "metric_names": [
            "cluster_ext_authz_ok_total",
            "cluster_ext_authz_error_total",
            "cluster_ext_authz_denied_total",
            "cluster_ext_authz_disabled_total",
            "cluster_ext_authz_failure_mode_allowed_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*ext_authz_ok_total",
              "legend": "OK (Allowed)",
              "type": "rate"
            },
            {
              "metric": ".*ext_authz_error_total",
              "legend": "Error",
              "type": "rate"
            },
            {
              "metric": ".*ext_authz_denied_total",
              "legend": "Denied",
              "type": "rate"
            },
            {
              "metric": ".*ext_authz_disabled_total",
              "legend": "Disabled",
              "type": "rate"
            },
            {
              "metric": ".*ext_authz_failure_mode_allowed_total",
              "legend": "Failure Mode Allowed",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Header Mutation & Validation",
          "description": "Header mutation failures, invalid responses, and mutation-limit violations",
          "metric_names": [
            "cluster_ext_authz_invalid_total",
            "cluster_ext_authz_omitted_response_headers_total",
            "cluster_ext_authz_request_header_limits_reached_total",
            "cluster_ext_authz_response_header_limits_reached_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*ext_authz_invalid_total",
              "legend": "Invalid Mutation",
              "type": "rate"
            },
            {
              "metric": ".*ext_authz_omitted_response_headers_total",
              "legend": "Omitted Response Headers",
              "type": "rate"
            },
            {
              "metric": ".*ext_authz_request_header_limits_reached_total",
              "legend": "Request Mutation Limit",
              "type": "rate"
            },
            {
              "metric": ".*ext_authz_response_header_limits_reached_total",
              "legend": "Response Mutation Limit",
              "type": "rate"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - External Processing (ext_proc)",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Stream Lifecycle & Messaging",
          "description": "Tracks ext_proc gRPC stream creation, closures, message counts, and protocol errors",
          "metric_names": [
            "http_ext_proc_streams_started_total",
            "http_ext_proc_stream_msgs_sent_total",
            "http_ext_proc_stream_msgs_received_total",
            "http_ext_proc_spurious_msgs_received_total",
            "http_ext_proc_streams_closed_total",
            "http_ext_proc_streams_failed_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*ext_proc.*streams_started_total",
              "legend": "Streams Started",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*stream_msgs_sent_total",
              "legend": "Messages Sent",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*stream_msgs_received_total",
              "legend": "Messages Received",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*spurious_msgs_received_total",
              "legend": "Spurious Messages",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*streams_closed_total",
              "legend": "Streams Closed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*streams_failed_total",
              "legend": "Streams Failed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Timeouts, Failures & Mutations",
          "description": "Timeout-related events, failure_mode_allowed events, and header mutation rejections",
          "metric_names": [
            "http_ext_proc_failure_mode_allowed_total",
            "http_ext_proc_message_timeouts_total",
            "http_ext_proc_rejected_header_mutations_total",
            "http_ext_proc_override_message_timeout_received_total",
            "http_ext_proc_override_message_timeout_ignored_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*ext_proc.*failure_mode_allowed_total",
              "legend": "Failure Mode Allowed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*message_timeouts_total",
              "legend": "Message Timeouts",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*rejected_header_mutations_total",
              "legend": "Rejected Header Mutations",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*override_message_timeout_received_total",
              "legend": "Override Timeout Received",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*override_message_timeout_ignored_total",
              "legend": "Override Timeout Ignored",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Route Cache Operations",
          "description": "Tracks all clear_route_cache operations and their outcomes",
          "metric_names": [
            "http_ext_proc_clear_route_cache_ignored_total",
            "http_ext_proc_clear_route_cache_disabled_total",
            "http_ext_proc_clear_route_cache_upstream_ignored_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*ext_proc.*clear_route_cache_ignored_total",
              "legend": "Clear Cache Ignored",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*clear_route_cache_disabled_total",
              "legend": "Clear Cache Disabled",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*ext_proc.*clear_route_cache_upstream_ignored_total",
              "legend": "Upstream Clear Cache Ignored",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Local Rate Limit",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Rate Limiting Summary",
          "description": "Local HTTP rate limiter decisions and enforcement results",
          "metric_names": [
            "http_local_rate_limit_enabled_total",
            "http_local_rate_limit_ok_total",
            "http_local_rate_limit_rate_limited_total",
            "http_local_rate_limit_enforced_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*http_local_rate_limit.*enabled_total",
              "legend": "Enabled (Limiter Consulted)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_local_rate_limit.*ok_total",
              "legend": "OK (Under Limit)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_local_rate_limit.*rate_limited_total",
              "legend": "Rate Limited (No Token)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*http_local_rate_limit.*enforced_total",
              "legend": "Enforced (429 Returned)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Lua",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Lua Script Execution",
          "description": "Lua request/response handler executions and script errors",
          "metric_names": [
            "http_lua_errors_total",
            "http_lua_executions_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*lua.*errors_total",
              "legend": "Execution Errors",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*lua.*executions_total",
              "legend": "Executions",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - OAuth2",
      "is_collapsed": true,
      "panels": [
        {
          "title": "OAuth2 Authorization Summary",
          "description": "OAuth2 authentication outcomes, passthrough rules, unauthorized requests, and refresh token operations",
          "metric_names": [
            "oauth_failure_total",
            "oauth_passthrough_total",
            "oauth_success_total",
            "oauth_unauthorization_rq_total",
            "oauth_refreshtoken_success_total",
            "oauth_refreshtoken_failure_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*oauth_failure_total",
              "legend": "Failure (Denied)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*oauth_passthrough_total",
              "legend": "Passthrough Matched",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*oauth_success_total",
              "legend": "Success (Allowed)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*oauth_unauthorization_rq_total",
              "legend": "Unauthorized Requests",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*oauth_refreshtoken_success_total",
              "legend": "Refresh Token Success",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*oauth_refreshtoken_failure_total",
              "legend": "Refresh Token Failure",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - RBAC",
      "is_collapsed": true,
      "panels": [
        {
          "title": "RBAC Authorization & Shadow Rules",
          "description": "RBAC allow/deny decisions, shadow rule evaluations, and logging outcomes",
          "metric_names": [
            "http_rbac_allowed_total",
            "http_rbac_denied_total",
            "http_rbac_shadow_allowed_total",
            "http_rbac_shadow_denied_total",
            "http_rbac_logged_total",
            "http_rbac_not_logged_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*rbac.*allowed_total",
              "legend": "Allowed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rbac.*denied_total",
              "legend": "Denied",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rbac.*shadow_allowed_total",
              "legend": "Shadow Allowed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rbac.*shadow_denied_total",
              "legend": "Shadow Denied",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rbac.*logged_total",
              "legend": "Logged",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rbac.*not_logged_total",
              "legend": "Not Logged",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Router",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Router Core Metrics",
          "description": "Routing decisions, no-route conditions, direct responses, and overload shedding",
          "metric_names": [
            "http_no_route_total",
            "http_no_cluster_total",
            "http_rq_redirect_total",
            "http_rq_direct_response_total",
            "http_rq_total",
            "http_rq_reset_after_downstream_response_started_total",
            "http_rq_overload_local_reply_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*no_route_total",
              "legend": "No Route (404)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*no_cluster_total",
              "legend": "No Cluster (503)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rq_redirect_total",
              "legend": "Redirect",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rq_direct_response_total",
              "legend": "Direct Response",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rq_total",
              "legend": "Total Routed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rq_reset_after_downstream_response_started_total",
              "legend": "Reset After Response Start",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*rq_overload_local_reply_total",
              "legend": "Overload Local Reply (Load Shed)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        },
        {
          "title": "Virtual Cluster Metrics",
          "description": "Aggregated and specific upstream HTTP status codes, retries, timeouts and request timing per virtual cluster",
          "metric_names": [
            "vcluster_upstream_rq_xx_total",
            "vcluster_upstream_rq_specific_total",
            "vcluster_upstream_rq_retry_total",
            "vcluster_upstream_rq_retry_limit_exceeded_total",
            "vcluster_upstream_rq_retry_overflow_total",
            "vcluster_upstream_rq_retry_success_total",
            "vcluster_upstream_rq_timeout_total",
            "vcluster_upstream_rq_total",
            "vcluster_upstream_rq_time"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*vcluster.*upstream_rq_[0-9]{3}$",
              "legend": "Specific Status Code",
              "type": "rate"
            },
            {
              "metric": ".*vcluster.*upstream_rq_[0-9]xx$",
              "legend": "Aggregate Status Code (xXX)",
              "type": "rate"
            },
            {
              "metric": ".*vcluster.*upstream_rq_retry_total",
              "legend": "Retry Attempts",
              "type": "rate"
            },
            {
              "metric": ".*vcluster.*upstream_rq_retry_limit_exceeded_total",
              "legend": "Retry Limit Exceeded",
              "type": "rate"
            },
            {
              "metric": ".*vcluster.*upstream_rq_retry_overflow_total",
              "legend": "Retry Overflow",
              "type": "rate"
            },
            {
              "metric": ".*vcluster.*upstream_rq_retry_success_total",
              "legend": "Retry Success",
              "type": "rate"
            },
            {
              "metric": ".*vcluster.*upstream_rq_timeout_total",
              "legend": "Timeout",
              "type": "rate"
            },
            {
              "metric": ".*vcluster.*upstream_rq_total",
              "legend": "Total Upstream Requests",
              "type": "rate"
            },
            {
              "metric": ".*vcluster.*upstream_rq_time",
              "legend": "Upstream Request Time",
              "type": "histogram"
            }
          ]
        }
      ]
    },
    {
      "row_title": "HTTP Filter - Stateful Session",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Stateful Session Routing",
          "description": "Routed session requests, failed overrides, and requests with missing/invalid session state",
          "metric_names": [
            "http_stateful_session_routed_total",
            "http_stateful_session_failed_open_total",
            "http_stateful_session_failed_closed_total",
            "http_stateful_session_no_session_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*stateful_session.*routed_total",
              "legend": "Routed (Override Applied)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*stateful_session.*failed_open_total",
              "legend": "Failed Open (Fallback LB)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*stateful_session.*failed_closed_total",
              "legend": "Failed Closed (503)",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            },
            {
              "metric": ".*stateful_session.*no_session_total",
              "legend": "No Session / Extraction Failed",
              "type": "rate",
              "group_by": "envoy_http_conn_manager_prefix"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Listener Filter - HTTP Inspector",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Protocol Detection Statistics",
          "description": "HTTP protocol detection counts and read errors",
          "metric_names": [
            "http_inspector_read_error_total",
            "http_inspector_http10_found_total",
            "http_inspector_http11_found_total",
            "http_inspector_http2_found_total",
            "http_inspector_http_not_found_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "http_inspector_read_error_total",
              "legend": "Read Errors",
              "type": "rate"
            },
            {
              "metric": "http_inspector_http10_found_total",
              "legend": "HTTP/1.0 Found",
              "type": "rate"
            },
            {
              "metric": "http_inspector_http11_found_total",
              "legend": "HTTP/1.1 Found",
              "type": "rate"
            },
            {
              "metric": "http_inspector_http2_found_total",
              "legend": "HTTP/2 Found",
              "type": "rate"
            },
            {
              "metric": "http_inspector_http_not_found_total",
              "legend": "No HTTP Detected",
              "type": "rate"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Listener Filter - Local Rate Limit",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Socket Rate Limiting",
          "description": "Sockets closed due to listener-level rate limit enforcement",
          "metric_names": [
            "listener_local_ratelimit_rate_limited_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*listener_local_ratelimit.*rate_limited_total",
              "legend": "Rate Limited (Socket Closed)",
              "type": "rate"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Listener Filter - PROXY Protocol",
      "is_collapsed": true,
      "panels": [
        {
          "title": "General PROXY Protocol Handling",
          "description": "Connections with missing PROXY headers and allowed/disallowed behaviors",
          "metric_names": [
            "proxy_proto_not_found_disallowed_total",
            "proxy_proto_not_found_allowed_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*proxy_proto.*not_found_disallowed_total",
              "legend": "Not Found (Disallowed)",
              "type": "rate"
            },
            {
              "metric": ".*proxy_proto.*not_found_allowed_total",
              "legend": "Not Found (Allowed)",
              "type": "rate"
            }
          ]
        },
        {
          "title": "PROXY Protocol Version Metrics",
          "description": "Correctly parsed headers, disallowed versions, and parsing errors by PROXY version",
          "metric_names": [
            "proxy_proto_versions_v1_found_total",
            "proxy_proto_versions_v1_disallowed_total",
            "proxy_proto_versions_v1_error_total",
            "proxy_proto_versions_v2_found_total",
            "proxy_proto_versions_v2_disallowed_total",
            "proxy_proto_versions_v2_error_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": ".*proxy_proto.*versions.v1.*found_total",
              "legend": "v1 Found",
              "type": "rate"
            },
            {
              "metric": ".*proxy_proto.*versions.v1.*disallowed_total",
              "legend": "v1 Disallowed",
              "type": "rate"
            },
            {
              "metric": ".*proxy_proto.*versions.v1.*error_total",
              "legend": "v1 Error",
              "type": "rate"
            },
            {
              "metric": ".*proxy_proto.*versions.v2.*found_total",
              "legend": "v2 Found",
              "type": "rate"
            },
            {
              "metric": ".*proxy_proto.*versions.v2.*disallowed_total",
              "legend": "v2 Disallowed",
              "type": "rate"
            },
            {
              "metric": ".*proxy_proto.*versions.v2.*error_total",
              "legend": "v2 Error",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Legacy PROXY Protocol Metrics",
          "description": "Legacy error counter for backward compatibility",
          "metric_names": [
            "downstream_cx_proxy_proto_error_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "downstream_cx_proxy_proto_error_total",
              "legend": "Proxy Proto Error (Legacy)",
              "type": "rate"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Listener Filter - TLS Inspector",
      "is_collapsed": true,
      "panels": [
        {
          "title": "TLS / ALPN / SNI Inspection",
          "description": "TLS detection, ALPN negotiation, SNI parsing and oversized client hello events",
          "metric_names": [
            "tls_inspector_client_hello_too_large_total",
            "tls_inspector_tls_found_total",
            "tls_inspector_tls_not_found_total",
            "tls_inspector_alpn_found_total",
            "tls_inspector_alpn_not_found_total",
            "tls_inspector_sni_found_total",
            "tls_inspector_sni_not_found_total"
          ],
          "unit": "reqps",
          "queries": [
            {
              "metric": "tls_inspector_client_hello_too_large_total",
              "legend": "ClientHello Too Large",
              "type": "rate"
            },
            {
              "metric": "tls_inspector_tls_found_total",
              "legend": "TLS Found",
              "type": "rate"
            },
            {
              "metric": "tls_inspector_tls_not_found_total",
              "legend": "TLS Not Found",
              "type": "rate"
            },
            {
              "metric": "tls_inspector_alpn_found_total",
              "legend": "ALPN Found",
              "type": "rate"
            },
            {
              "metric": "tls_inspector_alpn_not_found_total",
              "legend": "ALPN Not Found",
              "type": "rate"
            },
            {
              "metric": "tls_inspector_sni_found_total",
              "legend": "SNI Found",
              "type": "rate"
            },
            {
              "metric": "tls_inspector_sni_not_found_total",
              "legend": "SNI Not Found",
              "type": "rate"
            }
          ]
        },
        {
          "title": "TLS Inspector Bytes Processed",
          "description": "Histogram showing how many bytes were analyzed for TLS/ALPN/SNI detection",
          "metric_names": [
            "tls_inspector_bytes_processed"
          ],
          "unit": "bytes",
          "queries": [
            {
              "metric": "tls_inspector_bytes_processed",
              "legend": "Bytes Processed",
              "type": "histogram"
            }
          ]
        }
      ]
    },
    {
      "row_title": "UDP Listener Filter - UDP Proxy",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Downstream UDP Session Metrics",
          "description": "Downstream UDP session lifecycle, datagrams, bytes, errors, and timeouts",
          "metric_names": [
            "udp_downstream_sess_no_route_total",
            "udp_downstream_sess_rx_bytes_total",
            "udp_downstream_sess_rx_datagrams_total",
            "udp_downstream_sess_rx_errors_total",
            "udp_downstream_sess_total_total",
            "udp_downstream_sess_tx_bytes_total",
            "udp_downstream_sess_tx_datagrams_total",
            "udp_downstream_sess_tx_errors_total",
            "udp_idle_timeout_total",
            "udp_session_filter_config_missing_total",
            "udp_downstream_sess_active"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*udp.*downstream_sess_no_route_total",
              "legend": "No Route",
              "type": "rate"
            },
            {
              "metric": ".*udp.*downstream_sess_rx_bytes_total",
              "legend": "RX Bytes",
              "type": "rate"
            },
            {
              "metric": ".*udp.*downstream_sess_rx_datagrams_total",
              "legend": "RX Datagrams",
              "type": "rate"
            },
            {
              "metric": ".*udp.*downstream_sess_rx_errors_total",
              "legend": "RX Errors",
              "type": "rate"
            },
            {
              "metric": ".*udp.*downstream_sess_total_total",
              "legend": "Sessions Created",
              "type": "rate"
            },
            {
              "metric": ".*udp.*downstream_sess_tx_bytes_total",
              "legend": "TX Bytes",
              "type": "rate"
            },
            {
              "metric": ".*udp.*downstream_sess_tx_datagrams_total",
              "legend": "TX Datagrams",
              "type": "rate"
            },
            {
              "metric": ".*udp.*downstream_sess_tx_errors_total",
              "legend": "TX Errors",
              "type": "rate"
            },
            {
              "metric": ".*udp.*idle_timeout_total",
              "legend": "Idle Timeouts",
              "type": "rate"
            },
            {
              "metric": ".*udp.*session_filter_config_missing_total",
              "legend": "Config Missing",
              "type": "rate"
            },
            {
              "metric": ".*udp.*downstream_sess_active",
              "legend": "Active Sessions",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "Standard Upstream Metrics",
          "description": "Cluster-level upstream UDP stats including health, overflow and byte counts",
          "metric_names": [
            "upstream_cx_none_healthy_total",
            "upstream_cx_overflow_total",
            "upstream_cx_rx_bytes_total",
            "upstream_cx_tx_bytes_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*upstream_cx_none_healthy_total",
              "legend": "No Healthy Upstream",
              "type": "rate"
            },
            {
              "metric": ".*upstream_cx_overflow_total",
              "legend": "Overflow",
              "type": "rate"
            },
            {
              "metric": ".*upstream_cx_rx_bytes_total",
              "legend": "Upstream RX Bytes",
              "type": "rate"
            },
            {
              "metric": ".*upstream_cx_tx_bytes_total",
              "legend": "Upstream TX Bytes",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Custom Upstream UDP Metrics",
          "description": "Cluster-specific UDP stats including tunnel establishment and datagram errors",
          "metric_names": [
            "cluster_udp_sess_rx_datagrams_total",
            "cluster_udp_sess_rx_datagrams_dropped_total",
            "cluster_udp_sess_rx_errors_total",
            "cluster_udp_sess_tx_datagrams_total",
            "cluster_udp_sess_tx_errors_total",
            "cluster_udp_sess_tunnel_success_total",
            "cluster_udp_sess_tunnel_failure_total",
            "cluster_udp_sess_tunnel_buffer_overflow_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*cluster.*udp.*sess_rx_datagrams_total",
              "legend": "RX Datagrams",
              "type": "rate"
            },
            {
              "metric": ".*cluster.*udp.*sess_rx_datagrams_dropped_total",
              "legend": "RX Dropped",
              "type": "rate"
            },
            {
              "metric": ".*cluster.*udp.*sess_rx_errors_total",
              "legend": "RX Errors",
              "type": "rate"
            },
            {
              "metric": ".*cluster.*udp.*sess_tx_datagrams_total",
              "legend": "TX Datagrams",
              "type": "rate"
            },
            {
              "metric": ".*cluster.*udp.*sess_tx_errors_total",
              "legend": "TX Errors",
              "type": "rate"
            },
            {
              "metric": ".*cluster.*udp.*sess_tunnel_success_total",
              "legend": "Tunnel Success",
              "type": "rate"
            },
            {
              "metric": ".*cluster.*udp.*sess_tunnel_failure_total",
              "legend": "Tunnel Failure",
              "type": "rate"
            },
            {
              "metric": ".*cluster.*udp.*sess_tunnel_buffer_overflow_total",
              "legend": "Tunnel Buffer Overflow",
              "type": "rate"
            }
          ]
        }
      ]
    },
    {
      "row_title": "Control Plane & xDS Statistics",
      "is_collapsed": true,
      "panels": [
        {
          "title": "Connected State",
          "description": "Whether Envoy is currently connected (1) or disconnected (0) from the management server",
          "metric_names": [
            "control_plane_connected_state"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "control_plane_connected_state",
              "legend": "Connected State",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "Rate Limit Enforced",
          "description": "Total number of times rate limiting was enforced for control plane requests",
          "metric_names": [
            "control_plane_rate_limit_enforced_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "control_plane_rate_limit_enforced_total",
              "legend": "Rate Limit Enforced",
              "type": "rate"
            }
          ]
        },
        {
          "title": "Pending Requests",
          "description": "Pending control plane requests when rate limiting occurred",
          "metric_names": [
            "control_plane_pending_requests"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "control_plane_pending_requests",
              "legend": "Pending Requests",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "xDS Config Reloads",
          "description": "API fetches that resulted in a configuration reload",
          "metric_names": [
            "config_reload_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*lds_config_reload_total",
              "legend": "Config Reload",
              "type": "rate"
            }
          ]
        },
        {
          "title": "xDS Config Reload Timestamp",
          "description": "Timestamp of last config reload in ms",
          "metric_names": [
            "config_reload_time_ms"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": ".*lds_config_reload_time_ms",
              "legend": "Config Reload Time",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "xDS Initial Fetch Timeout",
          "description": "Total number of initial fetch timeouts",
          "metric_names": [
            "init_fetch_timeout_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*lds_init_fetch_timeout_total",
              "legend": "Init Fetch Timeout",
              "type": "rate"
            }
          ]
        },
        {
          "title": "xDS Update Attempts",
          "description": "Total xDS API fetch attempts",
          "metric_names": [
            "update_attempt_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*lds_update_attempt_total",
              "legend": "Update Attempt",
              "type": "rate"
            }
          ]
        },
        {
          "title": "xDS Update Success",
          "description": "Total successful xDS API fetches",
          "metric_names": [
            "update_success_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*lds_update_success_total",
              "legend": "Update Success",
              "type": "rate"
            }
          ]
        },
        {
          "title": "xDS Update Failure",
          "description": "Total xDS API fetch failures due to network errors",
          "metric_names": [
            "update_failure_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*lds_update_failure_total",
              "legend": "Update Failure",
              "type": "rate"
            }
          ]
        },
        {
          "title": "xDS Update Rejected",
          "description": "Total xDS API fetch failures due to validation or schema errors",
          "metric_names": [
            "update_rejected_total"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*lds_update_rejected_total",
              "legend": "Update Rejected",
              "type": "rate"
            }
          ]
        },
        {
          "title": "xDS Last Successful Update Time",
          "description": "Timestamp of last successful update (ms since epoch)",
          "metric_names": [
            "update_time"
          ],
          "unit": "ms",
          "queries": [
            {
              "metric": ".*lds_update_time",
              "legend": "Last Update Time",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "xDS Version Hash",
          "description": "Hash of last successful configuration",
          "metric_names": [
            "version"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": ".*lds_version",
              "legend": "Version Hash",
              "type": "gauge"
            }
          ]
        },
        {
          "title": "xDS Control Plane Connected State",
          "description": "1 = connected, 0 = disconnected",
          "metric_names": [
            "control_plane_connected_state"
          ],
          "unit": "short",
          "queries": [
            {
              "metric": "control_plane_connected_state",
              "legend": "Connected",
              "type": "gauge"
            }
          ]
        }
      ]
    }
  ]
}